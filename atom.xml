<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://py.qiuxiangzhi.top</id>
    <title>千物语</title>
    <updated>2021-01-19T10:39:47.626Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://py.qiuxiangzhi.top"/>
    <link rel="self" href="https://py.qiuxiangzhi.top/atom.xml"/>
    <subtitle>无所谓，随缘更新～</subtitle>
    <logo>https://py.qiuxiangzhi.top/images/avatar.png</logo>
    <icon>https://py.qiuxiangzhi.top/favicon.ico</icon>
    <rights>All rights reserved 2021, 千物语</rights>
    <entry>
        <title type="html"><![CDATA[EveryDay Mail - Python每日邮件]]></title>
        <id>https://py.qiuxiangzhi.top/post/everyday-mail-python-mei-ri-you-jian/</id>
        <link href="https://py.qiuxiangzhi.top/post/everyday-mail-python-mei-ri-you-jian/">
        </link>
        <updated>2021-01-19T01:15:40.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>本来想写一些关于同学们都去实习了而我还没方向所感受到的惆怅，然后写着写着情绪开始不对了起来。。这明明是一篇快乐水文，快乐到连比赛也不会做，水到基本是搜索引擎内容无情的整合工具。</p>
</blockquote>
<h2 id="明确需求">明确需求</h2>
<p>Anyway，现在开始每日邮件小目标。假设你有下面的需求，我们该怎么用Python实现？</p>
<ol>
<li>想通过脚本每天自动爬取某工作网站上的各类实习信息，方便快速筛选海投；</li>
<li>想通过邮件每天发给自己，实时更新内容，省去网页一个一个查看；</li>
</ol>
<p>看起来上面的需求也只能使用Python完成了，好在Python足够简单且方便，那么我们需要理清上面Python写的难点在哪里。</p>
<h2 id="爬取网站信息">爬取网站信息</h2>
<p>首先，我们需要爬取信息。爬取信息部分难以完成的不是代码部分，网上有关爬虫的代码到处都是，但为何我们还是不会爬？因为现在的网站学会了反爬，要么是动态加载内容，要么字库加密，字库加密还分为动态和静态，动态还有循环变动，更别说需要cookies，需要伪装代理，需要缓慢爬取等。。。总之，反爬方式异常多，让我们很是头疼。</p>
<p>所以，这经常让我们看得懂代码，却不会做。实在令人头疼。那么，以实习僧网站为例，下面我来整理一下关于Python爬取网站信息有哪些步骤。</p>
<ol>
<li>
<p>学会查看并尊重网站的反爬规则，大多数网站都会在自己的网站放上一个robots.txt，以告诉互联网上的各路牛鬼蛇神，那些内容是允许的，虽然通常不会被遵守。如：<a href="https://taobao.com/robots.txt">淘宝网</a>，明确写明禁止百度爬虫爬取根目录下的所有内容，也即禁止百度搜索引擎直接搜索站内内容。（实习僧没有这个文件，故而放肆地作为吧）</p>
<figure data-type="image" tabindex="1"><img src="https://pic.imgdb.cn/item/600639c73ffa7d37b399824b.png" alt="image-20210119094542759" loading="lazy"></figure>
</li>
<li>
<p>明确需要爬取的信息，熟练使用浏览器的调试工具（如检查元素、查看页面源代码、Xpath路径获取、网络信息）。</p>
</li>
</ol>
<p>待续。。。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[DDPG(Deterministic Deep Policy Gradient)]]></title>
        <id>https://py.qiuxiangzhi.top/post/ddpgdeterministic-deep-policy-gradient/</id>
        <link href="https://py.qiuxiangzhi.top/post/ddpgdeterministic-deep-policy-gradient/">
        </link>
        <updated>2020-11-25T15:11:35.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>存在错误，仅供娱乐。</p>
</blockquote>
<h2 id="what-is-ddpg">What is DDPG ?</h2>
<p>DDPG, its full name is 'Deep Deterministic Policy Gradient'. We have learned the 'Policy Gradient' before, and 'Deep' means to use the deep neural network to fit the Q function.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>+</mo><mi>α</mi><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\theta = \theta + \alpha \triangledown_{\theta}J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>	(1)</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>Q</mi><mo>(</mo><msub><mi>s</mi><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup></msub><mo separator="true">,</mo><msub><mi>a</mi><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup></msub><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=t}^{T} \gamma^{t&#x27;-1} Q(s_{t&#x27;},a_{t&#x27;})))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>	(2)</p>
<p>What is the 'Deterministic'? We use the outputs of network to fit the mean and variance of normal distribution. And we sample actions from this distribution, it's not deterministic. Now, we just view the outputs as the actions, it is deterministic.</p>
<p>Let's review the DQN, the process shows it can not handle the continuous control problem. That's for we should get the maximize Q function with the optimizing action <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to arrive sate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>s</mi><msup><mi>i</mi><mo mathvariant="normal">′</mo></msup></msub></mrow><annotation encoding="application/x-tex">s_{i&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32797999999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<img src="https://pic2.zhimg.com/80/v2-f79600fe97c508e7984bd222ef3f587d_720w.jpg" style="zoom: 67%;" />
<p>So, how we solve this problem? Actually it's easy to get experience from DQN. We use the deep neural network to fit the Q function.</p>
<p>But the goal of the DDPG is to increase the grad. Because of the network actor is finding the maximized value. So it's a off-line strategy without the importance sampling.</p>
<img src="https://pic1.zhimg.com/80/v2-300bc62b29fa41b5ee5a11d8ae5ca128_720w.jpg" style="zoom:67%;" />
<p>Critic Network:</p>
<ul>
<li>We use the critic network to evaluate the Q function in current state and action.</li>
<li>Input elements: action, state.</li>
<li>Update method:</li>
<li>
<img src="https://pic1.imgdb.cn/item/5fc0c83315e77190846760ba.png" alt="image-20201127173444201" style="zoom: 33%;" />
</li>
</ul>
<p>Actor Network:</p>
<ul>
<li>We use the actor network to get the action.</li>
<li>Input elements: current state.</li>
<li>Update method:</li>
<li>
<img src="https://pic1.imgdb.cn/item/5fc0c86715e7719084677af2.png" alt="image-20201127173536387" style="zoom: 25%;" />
</li>
</ul>
<p>The logistical code step as follow:</p>
<img src="https://pic1.imgdb.cn/item/5fc0c42115e771908464c5a2.png" alt="image-20201127171715954" style="zoom:67%;" />
<p>And the the process as below (maybe not use TD-error):</p>
<img src="https://pic4.zhimg.com/v2-cca7a5ac0cab40cd63ad9fd3679ba333_1440w.jpg?source=172ae18b" style="zoom:67%;" />
<h2 id="where-the-difference-between-ddpg-and-pg-or-ac">Where the difference between DDPG and PG or AC?</h2>
<p>Compare with PG:</p>
<ol>
<li>PG uses the actor network to fit the distribution of action, is not deterministic. While ‘DDPG’ use the actor network to get the deterministic action which can maximize the Q function.</li>
<li>PG uses the  accumulative rewards to evaluate the advantage of next state compared with current state. While ‘DDPG’ use the another network which called critic to evaluate the action.</li>
<li>PG uses the same neural network to learn and make policy decision (on-policy). While ‘DDPG’ use the actor-critic to learn and target actor-critic network to make policy decision (off-policy) .</li>
<li>Of course, its update methods of parameters are different, refer to the forward theory classify.</li>
<li>PG sample a batch size sequential info set from the actor network, while ‘DDPG’ get from rely buffer uniform randomly.</li>
</ol>
<p>Compare with AC:</p>
<ol>
<li>Update method of AC, which is different:<img src="https://pic1.imgdb.cn/item/5fc0dd6c15e77190846db17c.png" style="zoom:33%;" /></li>
<li>AC use same net work to learn, critic and fit. It is an on-policy algorithm while ‘DDPG’ is not.<img src="https://pic1.imgdb.cn/item/5fc0dcea15e77190846d8f9f.png" style="zoom: 33%;" /></li>
<li>AC get the sequential samples from the network, while DDPG get uniform randomly from rely buffer.</li>
</ol>
<h2 id="how-about-the-code-of-ddpg">How about the code of DDPG?</h2>
<p><strong>Problem 1: Maze Navigation, we need to train the robot to get the right route from start to goal.</strong></p>
<img src="https://pic.imgdb.cn/item/5fb3f045b18d62711324ebc8.png" alt="image-20201117234605775" style="zoom: 50%;" />
<p>So, there are some parameters be definite in the below:</p>
<pre><code class="language-python">#Hyperparameters
lr_mu        = 0.0005
lr_q         = 0.001
gamma        = 0.99
train_times  = 10000
each_train_times = 10
batch_size   = 50
buffer_limit = 5000
tau          = 0.005 # for target network soft update
</code></pre>
<p>The environment settings as below:</p>
<pre><code class="language-bash"># Maze Nvigation
action_dims			= 2
state_dims			= 2
out_of_border_reward= -100
goal_area			= [0.4,0.5]^2
goal_area_reward	= 100
map_area			= [-0.5,0.5]^2
start_point			= [0,0]
other_area_in_map	= -1
action_lock			= [-0.1,0.1]^2
</code></pre>
<p>The result of ‘DDPG’ in Maze Navigation (it has trained 10000 epochs actually, and record the average reward every 20 steps):</p>
<img src="https://pic1.imgdb.cn/item/5fc261a2d590d4788a803a92.jpg" alt="save-lr_a0.0005-lr_q0.001-gamma0.99-batch_size5-train_steps10" style="zoom: 18%;" />
<p>It seems great, and it's really smoothly. I feel awesome with my code.</p>
<p>Really strange thing is I always get reward number: -104. Which means the robot run 4 steps in map area and steps out at the fifth step. Another strange thing is the robot thinks this is the best result in the mechanism of ‘DDPG’. How's the world? Maybe the inner goal area will be more friendly for the robot.</p>
<p><strong>Problem 2: We need to make the robot walk forward.</strong></p>
<p>I don't know the full informations about this environment. But I know the max location is infinite and the min is negative infinite. The max action step is 1, the min action step value is -1. And the observation of environment are 17 axis which action are 6. And I find a really funny video online, which used ‘PPO’ to train the robot take forward by the environment ‘HalfCheetah-v2’. And he used more than 0.2 million steps to train it. At that before, the robot even seemly don't take actions.</p>
<p>Here's the link: <a href="https://sites.google.com/view/onlineretailing/">PPO in HalfCheetah-v2 training.</a></p>
<p>The result of ‘DDPG’ in ‘HalfCheetah-v2’ which coded by myself:</p>
<img src="https://pic.imgdb.cn/item/5fccfa5e394ac523789bfad5.png" alt="b005ff05fc9dd18c7b7f2f7e37bb73d" style="zoom: 33%;" />
<p>Awesome, it's a really great result for me. I see the robot runs the first.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Actor-Critic]]></title>
        <id>https://py.qiuxiangzhi.top/post/actor-critic/</id>
        <link href="https://py.qiuxiangzhi.top/post/actor-critic/">
        </link>
        <updated>2020-11-12T15:10:57.000Z</updated>
        <content type="html"><![CDATA[<h2 id="lets-come-back-the-policy-gradient">Let's come back the Policy Gradient.</h2>
<h3 id="what-is-policy-gradient">What is Policy Gradient？</h3>
<p>It's just like this, it's core of PG. This is how we update the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> of the network.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>+</mo><mi>α</mi><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\theta = \theta + \alpha \triangledown_{\theta}J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>	(1)</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=1}^{T} \gamma^{t&#x27;-1} r(s_t^i,a_t^i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>	(2)</p>
<p>So, how I understand these parameters in the paradigm, like below:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> : which we don't need to focus on how to update it in the code, just need to know those are parameters in the neural network.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\triangledown_{\theta}J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> : means to get the grad of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">J_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> according to parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>.</p>
<p>i &amp; N: i is the current episode and N is the number of episodes.</p>
<p>t &amp; T: t is the current period and the T is the periods of an episode.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">a_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>: the action took in period t and episode i.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">s_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> : the state in period t and episode i.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> : the probability of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">a_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> is took in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">s_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>, and get it's logarithm.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span> : the discount of next period reward</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">\gamma^{t&#x27;-1} r(s_t^i,a_t^i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> : the future reward with discount.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_{t&#x27;=1}^{T} \gamma^{t&#x27;-1} r(s_t^i,a_t^i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> : the sum of all discounted rewards of an episode.</p>
<p>Actually, it works by MC sampling method to make the probability of the great route be the max. Like this, make the neural network more likely to output the right continuous actions in the specific period.</p>
<figure data-type="image" tabindex="1"><img src="https://upload.wikimedia.org/wikipedia/commons/7/74/Normal_Distribution_PDF.svg" alt="" loading="lazy"></figure>
<p>And, to make it more correctly with the reality, we just need the backward rewards to evaluate and update the neural network. The final paradigm like this:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=t}^{T} \gamma^{t&#x27;-t} r(s_t^i,a_t^i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>	(3)</p>
<h3 id="what-is-actor-critic">What is Actor-Critic?</h3>
<p>We use the neural network to fit the value function to evaluate the advantage of states. Like this:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>A</mi><mi>π</mi></msup><mo>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>)</mo><mo>=</mo><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>a</mi></msub><mo>)</mo><mo>+</mo><mi>γ</mi><msubsup><mi>V</mi><mi>ϕ</mi><mi>π</mi></msubsup><mo>(</mo><msubsup><mi>s</mi><mi>i</mi><mo mathvariant="normal">′</mo></msubsup><mo>)</mo><mo>−</mo><msubsup><mi>V</mi><mi>ϕ</mi><mi>π</mi></msubsup><mo>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">A^{\pi}(s_i,a_i)=r(s_i,a_a)+\gamma V^{\pi}_{\phi}(s_i&#x27;)-V_{\phi}^{\pi}(s_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1711079999999998em;vertical-align:-0.4192159999999999em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4168920000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192159999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.169216em;vertical-align:-0.4192159999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-2.4168920000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">ϕ</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4192159999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 	(4)</p>
<p>And the update paradigm is like this:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>J</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mo>≈</mo><msub><mo>∑</mo><mi>i</mi></msub><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msub><mi>a</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>s</mi><mi>i</mi></msub><mo>)</mo><msup><mi>A</mi><mi>π</mi></msup><mo>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta}J(\theta) \approx \sum_i \triangledown_{\theta}log\pi_{\theta}(a_i|s_i)A^{\pi}(s_i,a_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16195399999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 	(5)</p>
<p>It seems like Q-Learning.</p>
<h3 id="ho-about-the-code">Ho about the code?</h3>
<p><strong>Problem 1: Maze Navigation, we need to train the robot to get the right route from start to goal.</strong></p>
<img src="https://pic1.imgdb.cn/item/5fbfa29415e77190841b34de.png" alt="image-20201126204156433" style="zoom:50%;" />
<p>So, there are some parameters be definite in the below:</p>
<pre><code class="language-python">class Args:
    def __init__(self) -&gt; None:
        super(Args,self).__init__()
        self.env_chosse = 'MazeNavigation'      # default: MazeNavigation
        self.algorithm = 'PG'                   # default: PG
        self.env = None                         # default: None
        self.lr = 0.001							# learning rate
        self.gamma = 0.99						# discount rate of future reward
        self.input_dims = 2						# input dimensions of actor nerual network 
        self.h1_dims = 16						# hidden dimensions
        self.h2_dims = 16						# hidden dimensions
        self.actions = 2						# action dimensions, x_axis changes
        self.action_lock = 0.1					# max action value
        self.log_std_min = -20					# restrict the sigma
        self.log_std_max = 2					# restrict the sigma
        self.epoch_nums = 5000					# trainning rounds
        self.sample_nums = 3					# sample nums, MC method
        self.t_horizens = 20					# time horizens
        self.path = None                        # default: None
        self.critic_input_dims = 3				# critic input dimensions
        self.critic_values = 1					# critic critics the actions
</code></pre>
<p>And use the <code>nn.Linear</code> to create the full network layer, <code>torch.distributions.Normal</code> is the shape to fit the actions distribution. And its out is be limited to [-0.1, 0.1]. If the robot's location is in the first quadrant (the refer zero point is start, and the goal is [0.4-0.5, 0.4-0.5]), robot get the 0 reward, and other location get -1 reward.</p>
<p>After adjust the environments' parameters:</p>
<p>Terminal field and reward: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>0.4</mn><mo separator="true">,</mo><mn>0.5</mn><msup><mo>]</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">[0.4, 0.5]^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>,  20</p>
<p>Start point and reward: [0, 0], 0</p>
<p>Reward apart from terminal field of the map: -1</p>
<p>Reward when out of the border: -5</p>
<p>And the result of AC is:</p>
<img src="https://pic1.imgdb.cn/item/5fbfa2cb15e77190841b4185.jpg" alt="ACreward-loss-lr-0.001-gamma-0.99-sample_nums-3-t_horizens-20" style="zoom:18%;" />
<p>Seems great. Actually, the more simple the more efficient. And it can be a great explorer and learner.</p>
<p><strong>Notions:</strong> If you want to get the same great result, maybe you need to set the reward of out of border lower than the reward of arriving to terminal field.</p>
<p><strong>Problem 2: We need to make the robot walk forward.</strong></p>
<p>I don't know the full informations about this environment. But I know the max location is infinite and min is negative infinite. And the max action step is 1, the min action step value is -1. And the observation of environment are 17 axis which action are 6.</p>
<img src="https://pic1.imgdb.cn/item/5fbf98fe15e77190841883e0.png" alt="image-20201126200102958" style="zoom:25%;" />
<p>So, just different input dimensions and output dimensions, we get the bad results...Maybe we need more time horizons and large batch size. But unfortunately there's only CPU on laptop.</p>
<img src="https://pic1.imgdb.cn/item/5fbfadb515e77190841e9fb5.jpg" alt="ACreward-loss-lr-0.001-gamma-0.99-sample_nums-4-t_horizens-500" style="zoom:18%;" />
<p>OK, that's all, I'm being more negative in the record, and more concentrate on the reshow of the algorithm...I'm sorry for bad code style and bad result of the second robot.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Policy Gradient]]></title>
        <id>https://py.qiuxiangzhi.top/post/theres-no-good-results-but-i-have-some-thinkings/</id>
        <link href="https://py.qiuxiangzhi.top/post/theres-no-good-results-but-i-have-some-thinkings/">
        </link>
        <updated>2020-10-31T15:09:56.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>不建议当成学习资料，仅供娱乐。</p>
</blockquote>
<h3 id="what-is-policy-gradient">What is Policy Gradient？</h3>
<p>It's just like this, it's core of PG. This is how we update the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> of the network.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>=</mo><mi>θ</mi><mo>+</mo><mi>α</mi><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\theta = \theta + \alpha \triangledown_{\theta}J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>	(1)</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=1}^{T} \gamma^{t&#x27;-1} r(s_t^i,a_t^i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>	(2)</p>
<p>So, how I understand these parameters in the paradigm, like below:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> : which we don't need to focus on how to update it in the code, just need to know those are parameters in the neural network.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\triangledown_{\theta}J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> : means to get the grad of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">J_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> according to parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>.</p>
<p>i &amp; N: i is the current episode and N is the number of episodes.</p>
<p>t &amp; T: t is the current period and the T is the periods of an episode.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">a_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>: the action took in period t and episode i.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">s_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> : the state in period t and episode i.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> : the probability of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">a_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> is took in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">s_t^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071664em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>, and get it's logarithm.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span> : the discount of next period reward</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo></mrow><annotation encoding="application/x-tex">\gamma^{t&#x27;-1} r(s_t^i,a_t^i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.19248em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> : the future reward with discount.</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mn>1</mn></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_{t&#x27;=1}^{T} \gamma^{t&#x27;-1} r(s_t^i,a_t^i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2809409999999999em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> : the sum of all discounted rewards of an episode.</p>
<p>Actually, it works by MC sampling method to make the probability of the great route be the max. Like this, make the neural network more likely to output the right continuous actions in the specific period.</p>
<figure data-type="image" tabindex="1"><img src="https://upload.wikimedia.org/wikipedia/commons/7/74/Normal_Distribution_PDF.svg" alt="" loading="lazy"></figure>
<p>And, to make it more correctly with the reality, we just need the backward rewards to evaluate and update the neural network. The final paradigm like this:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=t}^{T} \gamma^{t&#x27;-t} r(s_t^i,a_t^i)))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>	(3)</p>
<h3 id="what-is-natural-policy-gradient">What is Natural Policy Gradient?</h3>
<p>We may should to sample a large set of trajectories if we train the model by the vanilla PG because of the large variance taken by the reward. Surely we can decrease the variance according to make the reward cut the <strong>baseline</strong>.  The baseline can be the average value of reward of an episode. Like the follow paradigm:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo>(</mo><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>π</mi><mi>θ</mi></msub><mo>(</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mi mathvariant="normal">∣</mi><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>(</mo><msubsup><mo>∑</mo><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>t</mi></mrow><mi>T</mi></msubsup><msup><mi>γ</mi><mrow><msup><mi>t</mi><mo mathvariant="normal">′</mo></msup><mo>−</mo><mi>t</mi></mrow></msup><mi>r</mi><mo>(</mo><msubsup><mi>s</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>a</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>−</mo><mi>b</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta} = \frac{1}{N} \sum_{i=1}^{N} (\sum_{t=1}^{T} \triangledown_{\theta} log \pi_{\theta}(a_t^i|s_t^i)(\sum_{t&#x27;=t}^{T} \gamma^{t&#x27;-t} r(s_t^i,a_t^i)-b))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.94248em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> 	(4)</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>=</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>r</mi><mo>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">b = \frac{1}{T} \sum_{t=1}^T r(s_t,a_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.326231em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 	(5)</p>
<p>At the before, we use the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to update the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> . There's no doubt it's a feasible method but not efficient. The optimizer need to find the direction and distance of the new parameters. We view the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> as the distance and the update direction. But for the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> it self, it's a distribution parameters, not so involved with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>θ</mi></msub><msub><mi>J</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\triangledown_{\theta} J_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09618em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> . We need to know how to calculate the distance. Maybe the KL divergence can help us:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo>=</mo><mo>∫</mo><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mrow><mi>p</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>q</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow></mfrac><mi>d</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>d</mi><mi>T</mi></msup><msubsup><mi mathvariant="normal">▽</mi><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup><mn>2</mn></msubsup><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo>(</mo><msub><mi>π</mi><mi>θ</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>π</mi><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup></msub><mo>)</mo><msub><mi mathvariant="normal">∣</mi><mrow><msup><mi>θ</mi><mo mathvariant="normal">′</mo></msup><mo>=</mo><mi>θ</mi></mrow></msub><mi>d</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi>d</mi><mi>T</mi></msup><mi>F</mi><mo>(</mo><mi>θ</mi><mo>)</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">D_{KL}=\int p(x)log \frac{p(x)}{q(x)}d(x) = \frac{1}{2}d^T \triangledown_{\theta&#x27;}^2D_{KL}(\pi_{\theta}||\pi_{\theta&#x27;})|_{\theta&#x27;=\theta}d = \frac{1}{2}d^TF(\theta)d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828285714285715em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault">d</span></span></span></span> 	(6)</p>
<p>And our target is:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi><mo>←</mo><mi>θ</mi><mo>+</mo><msup><mi>d</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\theta \leftarrow \theta + d^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span>	(7)</p>
<p>We need to find the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">d^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span> , by making the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>(</mo><mi>θ</mi><mo>+</mo><mi>d</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">J(\theta+d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span> :</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>∗</mo></msup><mo>=</mo><msub><mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi></mo><mi>d</mi></msub><mi>J</mi><mo>(</mo><mi>θ</mi><mo>+</mo><mi>d</mi><mo>)</mo><mo separator="true">,</mo><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo>(</mo><msub><mi>π</mi><mi>θ</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>π</mi><mrow><mi>θ</mi><mo>+</mo><mi>d</mi></mrow></msub><mo>≤</mo><mi>ϵ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">d^* = \mathop{argmax}\limits_{d} J(\theta+d), s.t.D_{KL}(\pi_{\theta}||\pi_{\theta+d}\leq \epsilon)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.696548em;vertical-align:-0.946548em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">ma</span><span class="mord mathdefault">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.946548em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span><span class="mord mathdefault mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="mbin mtight">+</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">ϵ</span><span class="mclose">)</span></span></span></span> 	(8)</p>
<p>Finally we need to solve the paradigm 8, the results is:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>θ</mi><mi>k</mi></msub><mo>+</mo><msqrt><mfrac><mrow><mn>2</mn><mi>ϵ</mi></mrow><mrow><msubsup><mi>g</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi>H</mi><mi>k</mi></msub><msub><mi>g</mi><mi>k</mi></msub></mrow></mfrac></msqrt><msubsup><mi>H</mi><mi>k</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>g</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\theta_{k+1}=\theta_k + \sqrt{\frac{2\epsilon}{g_k^TH_kg_k}}H^{-1}_kg_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.7504885000000001em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0895115em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.606975em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8328928571428572em;"><span style="top:-2.1527714285714286em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-2.8448em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472285714285714em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.08125em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">ϵ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.636085em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0495114999999995em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M1001,80H400000v40H1013.1s-83.4,268,-264.1,840c-180.7,
572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,
-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744c-10,12,-21,25,-33,39s-32,39,-32,39
c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30c26.7,-32.7,52,-63,76,-91s52,-60,52,-60
s208,722,208,722c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,
-658.5c53.7,-170.3,84.5,-266.8,92.5,-289.5c4,-6.7,10,-10,18,-10z
M1001 80H400000v40H1013z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7504885000000001em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.3986920000000005em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 	(9)</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">H_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: the Hessian matrix of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> at the point K</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>g</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">g_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: the Policy gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> at the point K</p>
<h3 id="how-about-the-code">How about the code?</h3>
<p><strong>Problem 1: Maze Navigation, we need to train the robot to get the right route from start to goal.</strong></p>
<img src="https://pic.imgdb.cn/item/5fb3f045b18d62711324ebc8.png" alt="image-20201117234605775" style="zoom: 50%;" />
<p>So, there are some parameters be definite in the below:</p>
<pre><code class="language-python">class Args:
    def __init__(self) -&gt; None:
        super(Args,self).__init__()
        self.env_chosse = 'MazeNavigation'      # default: MazeNavigation
        self.algorithm = 'PG'                   # default: PG
        self.env = None                         # default: None
        self.lr = 0.001							# learning rate
        self.gamma = 0.99						# discount rate of future reward
        self.input_dims = 2						# input dimensions of actor nerual network 
        self.h1_dims = 16						# hidden dimensions
        self.h2_dims = 16						# hidden dimensions
        self.actions = 2						# action dimensions, x_axis changes
        self.action_lock = 0.1					# max action value
        self.log_std_min = -20					# restrict the sigma
        self.log_std_max = 2					# restrict the sigma
        self.epoch_nums = 5000					# trainning rounds
        self.sample_nums = 3					# sample nums, MC method
        self.t_horizens = 20					# time horizens
        self.path = None                        # default: None
        self.critic_input_dims = 3				# critic input dimensions
        self.critic_values = 1					# critic critics the actions
</code></pre>
<p>And use the <code>nn.Linear</code> to create the full network layer, <code>torch.distributions.Normal</code> is the shape to fit the actions distribution. And its out is be limited to [-0.1, 0.1]. If the robot's location is in the first quadrant (the refer zero point is start, and the goal is [0.4-0.5, 0.4-0.5]), robot get the 0 reward, and other location get -1 reward.</p>
<p>The result is great than I expected, that's in below(PG before):</p>
<img src="https://pic.imgdb.cn/item/5fb3f2b4b18d62711325ff57.jpg" alt="Lr-0.001-Gamma-0.99-Reward-Loss" style="zoom: 25%;" />
<p>After adjust the environments' parameters:</p>
<p>Terminal field and reward: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>0.4</mn><mo separator="true">,</mo><mn>0.5</mn><msup><mo>]</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">[0.4, 0.5]^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mord">.</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>,  20</p>
<p>Start point and reward: [0, 0], 0</p>
<p>Reward apart from terminal field of the map: -1</p>
<p>Reward when out of the border: -100</p>
<p>And the result of PG is:</p>
<img src="https://pic1.imgdb.cn/item/5fbf951715e771908417692d.jpg" alt="PGreward-loss-lr-0.001-gamma-0.99-sample_nums-3-t_horizens-20" style="zoom:18%;" />
<p>And the result of NPG is:</p>
<img src="https://pic1.imgdb.cn/item/5fbf96c115e771908417d381.jpg" alt="NPGreward-loss-lr-0.001-gamma-0.99-sample_nums-3-t_horizens-20" style="zoom:18%;" />
<p>Seems badly? Yes, there are some special code difficulties in calculating the matrix, <strong>I know how to get the grad and update the neural network, nothing know about how to do it in hand. And the grad Hessian matrix is more difficult to calculate than the previous.</strong></p>
<p><strong>Notions:</strong> If you want to get the same result of PG in Maze Navigation, you may need to set the reward of out of the border larger than the reward of arriving terminal yield.</p>
<p><strong>Problem 2: We need to make the robot walk forward.</strong></p>
<p>I don't know the full informations about this environment. But I know the max location is infinite and min is negative infinite. And the max action step is 1, the min action step value is -1. And the observation of environment are 17 axis which action are 6.</p>
<img src="https://pic1.imgdb.cn/item/5fbf98fe15e77190841883e0.png" alt="image-20201126200102958" style="zoom:25%;" />
<p>So, just different input dimensions and output dimensions, we get the bad results(PG)...</p>
<img src="https://pic1.imgdb.cn/item/5fbf9ac515e771908418fc19.jpg" alt="PGreward-loss-lr-0.001-gamma-0.99-sample_nums-4-t_horizens-50" style="zoom:18%;" />
<p>And the result of NPG:</p>
<img src="https://pic1.imgdb.cn/item/5fbfaf9115e77190841f4c06.jpg" alt="NPGreward-loss-lr-0.001-gamma-0.99-sample_nums-4-t_horizens-50" style="zoom:18%;" />
<p>If the result of PG is partly incorrectly, I can be surely say the result of NPG is unbelievable. So, there's something wrong in updating model. Maybe the KL divergence matrix is wrongly calculated.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Python学习历程]]></title>
        <id>https://py.qiuxiangzhi.top/post/python-xue-xi-li-cheng/</id>
        <link href="https://py.qiuxiangzhi.top/post/python-xue-xi-li-cheng/">
        </link>
        <updated>2020-10-30T15:15:45.000Z</updated>
        <content type="html"><![CDATA[<p>慢慢地我也学完了 <code>Python</code> 的基础语法，至于说掌握吸收了多少我也不清楚，浑浑噩噩。</p>
<p>但确实是不太想也不太需要补基础了，就来这里写一下我的学习历程。</p>
<h2 id="学习一-初识python啊python真好玩">学习一 初识Python，啊，Python真好玩</h2>
<p>首先我在本科大四的时候选修了一门课，《Python 数据处理》，当时想着，反正以后要用到<code>Python</code>的吧，而且都大四了，分数也不是很所谓。本着多学一门赚一门的想法（完全没想到会有超学分补学费的痛苦过程），也就选上了。</p>
<p>去了之后，发现同班同学全都会基础语法，我与本专业同学就瑟瑟发抖，每次上课都励志一定好好学基础，下课则下次一定。啊，多么咸鱼的时光，哈哈哈。然后老师在上面讲的是<code>numpy</code>、<code>pandas</code>这类数据处理利器的使用，期间夹杂了很多关于切片、聚合、分组处理数据的办法，（现在依稀回想觉得老师）讲的真好。</p>
<p>讲完<code>numpy</code>、<code>pandas</code>之后给我们介绍<code>matplotlib</code>，这是一个丑丑的画图包，当然偏向科学画图，立志取代<code>matlab</code>画图的有志向的包呢！最后老师还讲了讲爬虫，但我实在是对爬虫爱不起来，因为我实战的时候还不如前面的数据分析。。。</p>
<p>然而这一切的美好都在课堂上完全跟不上老师的逻辑，以及期中考试该死的手撕代码打破了！！！更恐怖的是，竟然期末考核是一个数据处理大作业！啊，平时爱得死去活来的大作业，当它碰上了基础不会、进阶不懂的人，还要求上台作<code>Presentation</code>，简直就是不给你60+还要公开处刑你的大恶人！！！</p>
<p>这里简单描述下我的大作业：</p>
<blockquote>
<p>一共1011个<code>PDF</code>文档，从某某标准网上爬下来的数据，作为数据处理源</p>
<ol>
<li>首先需要做的是，从中提取出来13项指定信息，并汇总到一个<code>Excel</code>中；</li>
<li>其次，需要对该13项指定信息进行分析，得到有效的结论；</li>
</ol>
</blockquote>
<p>啊，看起来真是简单呢，因为跟这个作业相对的是自己从网上爬取数据，数据源都要自己找呢。</p>
<h2 id="学习二-面向百度编程恶补pythonpython真有意思">学习二 面向百度编程恶补Python，Python真有意思</h2>
<p>因为这个作业看起来就很恐怖，所以我想起来伟大领袖毛爷爷的话，从战略上藐视对方，从战术上重视对方。</p>
<p>然后，然后自我安慰，一定能做完的叭，于是拖到了上台报告前最后两周。。。</p>
<p>啊，咸鱼的生活可真美好。</p>
<p>倒数第二周疯狂开始百度搜索各种错误，各种程序代码，各种理解并魔改。。。</p>
<p>基本思路就是这样的：</p>
<p>比如解决一个批量复制文件并改名的操作，因为要从老师给的压缩包里解压出来的各种子文件夹里的PDF文件整理并复制出来（这里的文件与子文件夹命名并没有强关联），然后对复制出来的PDF文件们进行批量重命名，这有利于我在后续某个文件出问题时快速定位比对源文件。扯远了，回到这个问题的解决过程。。。</p>
<blockquote>
<ol>
<li>如何定位每个子文件夹呢，于是百度怎么获得文件夹下面的所有文件夹</li>
<li>怎么得到子文件夹里所有的文件呢，卧槽这个也不会，查查</li>
<li>我要怎么把它们复制出来啊，我擦复制什么函数来着，路径要不要是绝对路径来着，赶紧上百度</li>
<li>。。。<br>
。。。<br>
n. 终于解决了文件复制重命名，开森，然后看看代码，嗯，全都没记住，暴风哭泣。。。</li>
</ol>
</blockquote>
<p>在经历了这么几个过程之后，我艰难的把大作业完成了，(｡･∀･)ﾉﾞ嗨，真难</p>
<p><strong>数据提取</strong><br>
复制文件 - 对文件改名 - 分割PDF为图片 - 对图片按PDF分类 - 将图片进行压缩 - 上传到百度OCR识别接口 - 将返回的txt放在对应PDF的子文件夹 - 拼接txt - 正则表达式匹配数据提取 - 缺项情况查看 - 改进正则表达式 - 缺项情况查看 - 改进正则表达式 - 缺... - ... - 保存数据到Excel文件 -完成数据提取！</p>
<p><img src="https://pic.downk.cc/item/5f7c8713160a154a6706d595.png" alt="img" loading="lazy"><br>
<img src="https://pic.downk.cc/item/5f7c8713160a154a6706d59a.png" alt="img" loading="lazy"><br>
<img src="https://pic.downk.cc/item/5f7c8718160a154a6706d761.png" alt="img" loading="lazy"></p>
<p><strong>数据分析</strong><br>
对数据进行统计 - 缺项数据解释 - 对各项数据简单分析 - 联合几项数据分析 - 得到初步结论 - 查找资料佐证 - 修改结论 - 查找资料佐证 - 修改结论 - ... - 得到最后展示文件</p>
<p><img src="https://pic.downk.cc/item/5f7c8713160a154a6706d58a.png" alt="img" loading="lazy"><br>
<img src="https://pic.downk.cc/item/5f7c8713160a154a6706d58c.png" alt="img" loading="lazy"><br>
<img src="https://pic.downk.cc/item/5f7c8713160a154a6706d58f.png" alt="img" loading="lazy"></p>
<p>各位如果有兴趣，可以看看这里我的大作业，需要配置 <code>Python</code> 加 <code>Jupyter notebook</code> 环境。</p>
<figure data-type="image" tabindex="1"><img src="https://pic.downk.cc/item/5f7c87ac160a154a670704b8.png" alt="img" loading="lazy"></figure>
<p><strong>原始数据：</strong></p>
<blockquote>
<p>链接：https://pan.baidu.com/s/1bWuz43Ldu-KoxzVzvfaDBw<br>
提取码：xqk9</p>
</blockquote>
<p><strong>作业成品：</strong></p>
<blockquote>
<p>链接：https://pan.baidu.com/s/1c26l1O-C2zVfUNgjnx5UDQ<br>
提取码：bls2</p>
</blockquote>
<p>这作业真的很磨人，近乎绝望，各种意外的情况，像是什么日文PDF啦、韩文PDF啦，像是什么图纸文件（根本不是标准文件）、施工方案、专利文件，以及什么空白PDF。。。</p>
<p>最折磨人的是，有些日期写的是“十月十五”，有的是10.15，有的是10-15，有的是98.05、1998.05、1998-05、1998-05-27、零八五月、零八年五月。。。就是这些“-”、“.”以及中文数字、日期长度之类的无穷组合。。。。</p>
<p>以及所谓的英文标题，拜托，现在谁还专门在title的地方告诉你，这玩意是title。。。</p>
<p><strong>实名（我这实名了个锤锤）感谢我的老师，大家都90+（我是没+的）过的，开心极了。</strong><br>
<img src="https://pic.downk.cc/item/5f7c886d160a154a6707360e.png" alt="img" loading="lazy"></p>
<h2 id="学习三-下定决定好好学python呢这该死的可爱的语气">学习三 下定决定好好学Python呢，这该死的可爱的语气</h2>
<p>基于我的C语言就是从B站、网易云课堂找到的，我也在B站、网易云课堂找了找相关的免费课程。但一趟学下来，感觉收获不少，又感觉没学到什么。因为在项目实战中该学的都用到了，因此学习的时候又回忆起来了，这就索然无味。</p>
<p><a href="https://www.bilibili.com/video/BV1ex411x7Em">Python教程_600集Python从入门到精通教程（懂中文就能学会）</a></p>
<iframe src="https://player.bilibili.com/player.html?aid=14184325&amp;bvid=BV1ex411x7Em&amp;cid=23153678&amp;page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="margin: 0px; border: 0px; vertical-align: baseline; box-sizing: border-box; caret-color: rgb(85, 85, 85); color: rgb(85, 85, 85); font-family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 15px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; text-decoration: none;"></iframe>
<p>接着基于网易云找到了一堂课，学的是真的补的漏啊，像是字符串的新鲜操作，超级满足我的缺漏，于是我觉得这大概就是很好的课程了。连带着我觉得老师的声音都贼好听~</p>
<p><a href="https://study.163.com/course/courseMain.htm?courseId=1005859011">Python 语言基础</a><br>
<img src="https://edu-image.nosdn.127.net/f5af698c-188d-454c-8c9b-5fac9acd3368.png?imageView&amp;quality=100&amp;crop=0_0_1920_1077&amp;thumbnail=450y250" alt="img" loading="lazy"></p>
<h2 id="学习四-学python怎么能干学呢来点题目">学习四 学Python怎么能干学呢，来点题目</h2>
<p>说到学代码，最好的当然是实战刷题啦，记得又牢，又有意思，问题也比较多就是，比如一做可能就是一晚上。。。</p>
<p>而且不是自己接出来，看别人的思路总是不痛快。。。</p>
<p>这里推荐我用过的 <code>LeetCode</code> 吧，<a href="https://leetcode-cn.com/">网址在这里。</a></p>
<p>比如其中一道题是这样的：</p>
<p><img src="https://pic.downk.cc/item/5f7c81f7160a154a67055eac.png" alt="img" loading="lazy"><br>
<img src="https://pic.downk.cc/item/5f7c81f7160a154a67055eaf.png" alt="img" loading="lazy"></p>
<p>稍微思考一下，就可以利用循环去做，还是比较简单的。当然现在让我重新写，估计我可以写更加高级的操作。但，也许效率并不会提升就是，哈哈哈哈。</p>
<pre><code class="language-python">class Solution:
    def countAndSay(self, n: int) -&gt; str:
        last = ''
        for i in range(n):
            string = ''
            if i == 0:
                string = '1'
            else:
                count = 0
                temp_string = ''
                for j in last:
                    if temp_string == '':
                        temp_string = j
                        count += 1
                    elif j == temp_string:
                        count += 1
                    else:
                        string += str(count)
                        string += temp_string
                        count = 1
                        temp_string = j
            if i != 0:
                string += str(count)
                string += temp_string
            last = string
        return last
复制代码
</code></pre>
<p>然后通过啦，经过思考，优化了一小节，成绩提升了，然后成就感就来了，同时也熟悉了Python的操作，多好啊。</p>
<figure data-type="image" tabindex="2"><img src="https://pic.downk.cc/item/5f7c81f7160a154a67055eb1.png" alt="img" loading="lazy"></figure>
<p>目前只做了这么些简单的题目，主要还是假期没怎么做，隔十天做一次这样。<br>
（啊别骂了别骂了，我菜我不对，呜呜呜呜）</p>
<figure data-type="image" tabindex="3"><img src="https://pic.downk.cc/item/5f7c81f7160a154a67055eb6.png" alt="img" loading="lazy"></figure>
<h2 id="学习五-我怎么又走了弯路暴风哭泣">学习五 我怎么又走了弯路，暴风哭泣。。。</h2>
<p>其实上面找到的教程还不是很好，因此我又在网易云课堂找啊找啊，终于找到个比较好的课啦。</p>
<p>果然，课没选对很多东西根本不会讲，尤其是涉及到内存的操作与理解，没有这些怎么进阶高级操作（插会腰装个B），哈哈哈哈。</p>
<p><a href="https://study.163.com/course/courseMain.htm?courseId=1005713007">python人工智能基础第一季</a></p>
<figure data-type="image" tabindex="4"><img src="https://pic.imgdb.cn/item/5f804e181cd1bbb86b9a4b87.png" alt="image-20201009194742614" loading="lazy"></figure>
<p>这个视频讲解对象是什么， <strong>Python</strong> 中对象在内存中是怎么样处理的，垃圾回收机制，以及类的继承操作等，讲的老详细了，超级推荐找一个靠谱的 <strong>Python</strong> 学习教程再开始！！！</p>
<p>当然，最好还是要跟着敲代码记笔记的，要是学习没有热情我建议跟我一样每天更新学习日记，来勉励自己哦。（虽然我这个学习笔记也不是每天更新，但是我更新了呀）</p>
<h2 id="总结">总结</h2>
<p>其实总的来说，学习Python还是比较简单入门的，就是 <strong>找一个靠谱的课程</strong> + <strong>小项目实战</strong> + <strong>题库练习</strong> + <strong>学习笔记</strong>，这些做好之后，学 <strong>Python</strong> 一点都不困呐</p>
<p>每天都活力满满呢~</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Q-Learning's learning note & sample show]]></title>
        <id>https://py.qiuxiangzhi.top/post/q-learnings-learning-note-and-sample-show/</id>
        <link href="https://py.qiuxiangzhi.top/post/q-learnings-learning-note-and-sample-show/">
        </link>
        <updated>2020-10-10T15:08:38.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>非常不合理的解释，请当娱乐笑料参考。</p>
</blockquote>
<h3 id="so-firstly-what-is-q-learning">So, firstly, what is Q-Learning?</h3>
<p>If we go for a shopping, goods list maybe is been prepared before. And we really know the reason why we add them to the list. Why we know that?</p>
<p>Haven't thought that? Yeah, that's why you think it's hard to learn Deep Reinforce Learning. That is we want to make the 'clever' program knows things like us. We can get the reason by one's tasty cooking, so we buy the food again in the next time.</p>
<p>So, Q-Learning is a kind of algorithms to help machine learn from environment (usually value feedback) by a Q-table. Q-table is machine's experience by many times attempts.</p>
<p>Actually we know there's a table (called R-table) in environment and machine have the similar Q-table. The machine receives the feedback and update its table.</p>
<h3 id="how-it-works">How it works</h3>
<p>Actually we need to split it as several process, it's under specific state and can make action. Sure we still don't know what will happen when making a strategic decision but we can get the value in current environment.</p>
<p>List these all as follows:</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> : A value feedback which machine don't know but will get in the next state after action</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> : Current state</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> : What we will do in current state</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> : How I feel in current state and action</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{t+1}(S_{t+1},a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> : How I feel in next state and unknown action</p>
<p>So, we have to make a decision to get the feedback from the environment to update our Q-value in current state. Hardly to understand?</p>
<p>It's just to do something bravely and get some experience to help we do decision in the next similar state. We need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> to update <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>And as know, if we still have no decision in something, we may check if there's some useful data in our experience. We need <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{t+1}(S_{t+1},a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> to update <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>. And don't forget it's just as a reference. So you need a factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">{\gamma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span></span></span></span></span> to decrease the effect.</p>
<p>Now we need to back to one person, utility is better to help you or the absolute value? So we need a difference between the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\gamma Q_{t+1}(S_{t+1},a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>.</p>
<p>We assume <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>γ</mi><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\gamma Q_{t+1}(S_{t+1},a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span> is bigger than <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, there is:</p>
<p>​				<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>−</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t) = Q_t(S_t,A_t) + R_{t+1} + \gamma Q_{t+1}(S_{t+1},a) - Q_t(S_t,A_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>But, really enough? Maybe not. Not the each strategy decision is right, we need a factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span></span> to decrease the probability of mistake. Like...this:</p>
<p>​				<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>α</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>−</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t) = Q_t(S_t,A_t) + \alpha ( R_{t+1} + \gamma Q_{t+1}(S_{t+1},a) - Q_t(S_t,A_t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<p>That seems perfect, but what have been forgotten? Yeah, that's &quot;a&quot; in  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_{t+1}(S_{t+1},a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>, to get the experience rapidly, maybe we can get the max value for each possible action &quot;a&quot;. The final really perfect Q-Learning Algorithm core theory:</p>
<p>​			<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>+</mo><mi>α</mi><mo>(</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><mi>m</mi><mi>a</mi><msub><mi>x</mi><mi>a</mi></msub><msub><mi>Q</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>a</mi><mo>)</mo><mo>−</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Q_t(S_t,A_t) = Q_t(S_t,A_t) + \alpha ( R_{t+1} + \gamma max_aQ_{t+1}(S_{t+1},a) - Q_t(S_t,A_t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<h3 id="how-to-make-it">How to make it</h3>
<p>Two examples given by teacher, let's see the first:</p>
<img src="https://pic.imgdb.cn/item/5f91a6d31cd1bbb86bcb5618.png" alt="迷宫1" style="zoom:50%;" />
<p>It looks like a chessboard. But its name is &quot;Maze Navigation&quot;. As the name say, it has terminal location and start. We need to find a way to not avoid in gray grid.</p>
<p>That's the logical code which is designed for solve this kind of problems:</p>
<img src="https://pic.imgdb.cn/item/5f91a7d61cd1bbb86bcb9541.png" alt="image-20201022234010847" style="zoom: 33%;" />
<img src="https://pic.imgdb.cn/item/5f91a7f61cd1bbb86bcb9cd9.png" alt="image-20201022234042597" style="zoom:33%;" />
<p>And I do the verification by python:</p>
<img src="https://pic.imgdb.cn/item/5f91a8b51cd1bbb86bcbc7bd.png" alt="image-20201022234353535" style="zoom:33%;" />
<p>There are some rules in the map:</p>
<ol>
<li>Gray grid: can't be reached, but get -10 (utility)</li>
<li>White grid: can be reached, and get 0 (utility)</li>
<li>Green grid: can be reached, and it's terminal, get 100 (utility)</li>
</ol>
<p>It's funny to see the robot find the way...</p>
<p>And here's the second sample:</p>
<img src="https://pic.imgdb.cn/item/5f91a9b11cd1bbb86bcc02e2.png" alt="迷宫2" style="zoom:33%;" />
<p>It's more complex than the previous map, and there are four kinds of grids:</p>
<ol>
<li>Gray grid: can't be reached, but get -10 (utility), the same as previous</li>
<li>White grid: can be reached, and get 0 (utility)</li>
<li>Green grid: can be reached, and it's terminal, get 300 (utility)</li>
<li>Red grid: can't be reached, but get -100(utility), it's a big trap...</li>
</ol>
<p>I do the program to run for it, it's a picture with &quot;.gif&quot; format. Maybe you can see the animation.</p>
<img src="https://pic.imgdb.cn/item/5f91a8341cd1bbb86bcbab06.gif" alt="憨憨2" style="zoom:33%;" />
<h3 id="thanks">Thanks</h3>
<p>OK, that's all I do. And there's code file in the zip. Maybe you need to read &quot;Readme.txt&quot; before you try to run it.</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[每个中二总会有的焦虑]]></title>
        <id>https://py.qiuxiangzhi.top/post/mei-ge-zhong-er-zong-hui-you-de-jiao-lu/</id>
        <link href="https://py.qiuxiangzhi.top/post/mei-ge-zhong-er-zong-hui-you-de-jiao-lu/">
        </link>
        <updated>2020-10-01T15:05:26.000Z</updated>
        <content type="html"><![CDATA[<h2 id="不接受平凡事实证明作业太少">不接受平凡？【事实证明作业太少】</h2>
<p>曾经我以为，我是不愿意接受平凡，所以总有这样那样的烦恼。比如经常忧虑我不如别人因此会找不到工作，比如经常认为我不能达到公司的要求因此找不到工作等等。因此经常感到郁闷，为此不惜到处跑，到处找人倾诉自己的压力，以及专门出去散心。这很有效，回来之后我觉得我没有那么大的心理压力了，我认为我放下了，我认为应该给自己放放假。</p>
<h2 id="不是习惯性焦虑且咸鱼综合症玩的太好">不，是习惯性焦虑且咸鱼综合症【玩的太好】</h2>
<p>但我发现我也只是限于忧虑，从来也没真的好好去学。突如起来的一些事情，经常很容易打断我的节奏，或者说可能形成的节奏。比如正在上自习，这时假如朋友一条微信，跟我说一起出去走走，那么我也就立刻放下书包出去了。比如学习英语，每次学的过程都既痛苦又开心，但只要有那么一点，只要那么一点点能让我开心的其他事情出现，比如仅仅是比别人先完成一份质量不明的作业，也就会让我有理由放松。或这样或那样的理由让我一次次放低自己的线，最后全然没有往前走的动力。说起来奋斗是苦的，我也知道那会是苦的。但我没想到，这苦是这么轻松战胜我的。</p>
<h2 id="啥都不懂也不会的懒人一个所以没事就">啥都不懂也不会的懒人一个【所以没事就】</h2>
<p>到了现在，实在是不明白自己是个什么样的人，说好的职业规划，人生规划也变得越来越模糊。我就是一个随波逐流地厉害的人，飘着，期待能靠一个大码头，还可以见识到沿途的风景。但正如我不学好英语，不学好技能，就永远不会也不可能靠上岸，也不可能看得到沿途的风景。谁说风景就是我天天感到焦虑，灰色样式的？谁说风景就是天天吃好喝好的无事发生？</p>
<h2 id="意识到且并不打算挣扎找到咸鱼的组织一起咸鱼喜欢焦虑">意识到且并不打算挣扎，找到咸鱼的组织，一起咸鱼【喜欢焦虑】</h2>
<p>我啊，大概是早就已经接受自己平凡了，只是死撑着觉得自己不应该呢，咸鱼从来不会因为翻身就不是咸鱼，也不会因为翻身就不粘锅，该粘还是得粘，该是咸鱼还是咸鱼。</p>
<p>我要做的，大概是找一条布满荆棘的小水洼路，从满是鲤鱼、鲫鱼的湖里，跳到不会被嘲笑的大海里（毕竟大海里面都是咸鱼，只有比谁更咸鱼）。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Loss of Loss Aversion: Did that loss is loom larger than gain?]]></title>
        <id>https://py.qiuxiangzhi.top/post/loss-of-loss-aversion-did-that-loss-is-loom-larger-than-gain/</id>
        <link href="https://py.qiuxiangzhi.top/post/loss-of-loss-aversion-did-that-loss-is-loom-larger-than-gain/">
        </link>
        <updated>2020-09-20T15:14:21.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>行为理论与行为决策分析</p>
<p>原文链接：<a href="https://www.notion.so/zekshawn/The-Loss-of-Loss-Aversion-bd9f570b6daf4aa6879f98eeb0bdec50">The Loss of Loss Aversion</a></p>
</blockquote>
<h1 id="摘要">摘要</h1>
<h2 id="中心讨论主旨">中心讨论主旨：</h2>
<ul>
<li>损失规避：损失大于收益的原则，更为社会科学领域所广泛接受</li>
</ul>
<h2 id="文章说明">文章说明：</h2>
<ul>
<li>文章第一部分介绍和讨论损失规避的构造 introdeucs and discusses the construct of Loss Aversion</li>
<li>文章第二部分审查了支持损失规避的证据 reviews the evidences in support of Loss Aversion / 第二部分结论为现有的理论不足以支撑损失规避理论，但趋向于比收益更有影响 the upshot of this review is that current evidence does not support that losses, on balance, tend to be any more impactful than gains</li>
<li>文章的第三部分查找损失规避原则被消费心理学家、社会科学家视为一般原则的原因，尽管现有理论都指向相反的结果 The third part of this article aims to address the question of why acceptance of loss aversion as a general principle remains pervasive and persistent among social scientists, including consumer psychologists, despite evidence to the contrary / 这个分析部分旨在连接由对损失规避原则的坚持和对一般地科学的信念接受和坚持 This analysis aims to connect the persistence of a belief in loss aversion to more general ideas about belief acceptance and persistence in science</li>
<li>文章的最后一部分讨论了，如何从更加情景化的视角去审视收益与损失的相互影响（impact），从而开辟新的研究领域，这些恰好在消费心理学的研究领域 The final part of the article discusses how a more contextualized perspective of the relative impact of losses versus gains can open new areas of inquiry that are squarely in the domain of consumer psychology</li>
</ul>
<h2 id="文章个人解读">文章（个人）解读：</h2>
<ul>
<li>结构很清晰，先对损失规避理论进行介绍，接着找寻支持该理论的证据并分析，然后找寻为何出现该结论的原因，最后引出新的研究方向（领域），文章真有水平。</li>
<li>初步得到结论，损失规避理论本身是有损的，也就是没有太多理论支撑；</li>
<li>其次，讨论损失与收益的时候，应该认识到，两者相互关联且情景影响大；</li>
</ul>
<h2 id="外部资料查询">外部资料查询：</h2>
<ul>
<li>损失规避原则：是指人们面对 同样数量的收益和损失 时，认为 损失更加令他们难以忍受。损失带来的 负效用为收益正效用的2至2.5倍 [1]。损失厌恶反映了人们的风险偏好并不是一致的，当涉及的是收益时，人们表现为风险厌恶；当涉及的是损失时，人们则表现为风险寻求。</li>
<li>解释：1. 面对同样数量的收益与损失时损失更加难以忍受，指的应该是损失时难受的程度比收益时喜悦的程度高，也即荣辱不一；2. 风险厌恶：一个人面对不确定收益的交易时，更倾向于选择较保险但是也可能具有较低期望收益的交易；3. 风险寻求：当有两个或多个可供选项时，个体更倾向选择风险较大的选项。</li>
<li>参考资料：<a href="https://zh.wikipedia.org/wiki/%E6%8D%9F%E5%A4%B1%E8%A7%84%E9%81%BF">损失规避原则 - 维基百科</a>，<a href="https://zh.wikipedia.org/wiki/%E9%A3%8E%E9%99%A9%E5%8E%8C%E6%81%B6">风险厌恶 - 维基百科</a>，<a href="https://baike.baidu.com/item/%E9%A3%8E%E9%99%A9%E5%AF%BB%E6%B1%82%E5%80%BE%E5%90%91">风险寻求倾向 - 百度百科</a></li>
</ul>
<h1 id="绪论">绪论</h1>
<blockquote>
<p>Cautions：这里的影响均为对决策时心理的影响，因而属于心理学领域研究范畴</p>
</blockquote>
<ul>
<li>开头先抛出一个问题，在2016年波士顿举办的80人参与的社会判断与决策制定会议上，探究收益与损失的影响哪个更为广大。会议上除了三个人外，其余都支持损失对决策的影响大于收益，没有一个人认为收益对决策的影响大于损失，只有三个人认为损失与收益对决策的心理影响相当。</li>
<li>上述表决放在上下文中，这发生在一次会议上，与会者意识到该会议的主题为挑战该观点：损失通常比收益的影响更为重大。 <code>事情变得有趣了起来，这是不是说，组织会议的家伙也在假装不知道，以达成戏剧化的效果呢？</code></li>
</ul>
<blockquote>
<p>10.9 更新</p>
</blockquote>
<h2 id="点名大佬-kahnemen-tversky">点名大佬 Kahnemen &amp; Tversky</h2>
<ul>
<li>绪论中先回顾了 K &amp; T 及诸多学者在解释一些著名的现象时，使用损失规避作为社会科学及心理学上的一般性原则解释，尤其是 Kahneman 得了 Nobel Prize 之后说，（损失规避）是他在行为决策分析领域及行为经济学上最大的贡献。（该部分仍需补充说明）</li>
<li>先说明在行为心理学界及社会科学领域，损失规避原则是多么通用，备受推崇。</li>
<li>接着说我在该文中，研究的结果并不是这样，至少不能被当作一般原则。损失与收益的相对关系并不单纯是损失大于收益，而是影响互有大小。最重要的是，应该有第四种情况，也就是根据具体的情景去分析，哪种原则比较适合。</li>
</ul>
<h2 id="个人小结">个人小结</h2>
<ul>
<li>大佬们说错啦，我说的才是对的，我有理有据，而且我还觉得你们确定的都是辣鸡玩意；</li>
<li>你们没考虑具体情境，只是解决了些特定情况下的解释悖论，不可以被当作通用原则的；</li>
<li>😈虽然本文也说了些废话，总结起来看情景的话，我觉得就没有原则了，换句话说，通篇废话主要反驳。</li>
</ul>
<blockquote>
<p>10.10 更新</p>
</blockquote>
<h1 id="part-1-review-the-principle-loss-aversion">Part 1 Review the Principle: Loss Aversion</h1>
<h2 id="两个特别的方面">两个特别的方面 🙄</h2>
<ul>
<li>几乎所有的文章上，关于损失规避都被写成了一个基础和通用的原则而不是情景化的 🤭</li>
<li>损失规避定义为心理学基本原则而不是心理过程，它被用来描述行为而不是解释行为 🤔</li>
<li>emmm，这到底说了个啥子啊？</li>
</ul>
<h2 id="进一步补充">进一步补充</h2>
<ul>
<li>第一点上的通用原则指的是，损失不是可以在少数情况比收益带来的效用更大，而是全都比收益要大 —— 感觉又强调了一遍情景化</li>
<li>K &amp; T 在 1986 年的文章，描述说到 “the generalization that losses are weighted substantially more than objectively commensurate gains”。收益大于损失所带来的心理效应；</li>
<li>有些人觉得不对，于是 K &amp; T 强调：“the response to losses is more extreme than the response to gains”，</li>
<li>求生欲：This observation is not to say that researchers who accept loss aversion as a generalized principle are so narrow as to explicitly state that loss aversion is universal.</li>
<li>提出：损失与收益带来的影响应该是互有胜负的，即使有些学者可能会拿“boundaries of loss aversion”来当说辞，我们也应该意识到，该理论是用来加深损失规避这一原则的。</li>
<li>K &amp; T 在2005年聚焦在一个点 “goods that are given up as intended do not exhibit loss aversion” ，指物品当被预期地那样被放弃（估计是想说损失）并不适用损失规避原则，给出的解释为，个人不会将预期的损失跟收益进行编码，也即不会在得到或者失去的一刹那被认为是收益或损失。</li>
<li>因而，作者认为这一原则原先的边界条件为，不能感知到损失而不是损失跟收益带来的效用相等。但作者觉得，这并不是损失规避的边界情况。（前面可都是作者写的）</li>
<li>K &amp; T说，不管何时，损失都是大于收益带来的效应的。 🤔</li>
<li>Ariely Huber Wertenbroch在2005年表示，我们不反驳这一陈述作为原则，但我们建议考虑加入损失规避的调节条件？原文：do not challenge the universality of the idea that losses fundamentally loom larger than gains, but suggest possible moderators of the degree of loss aversion.</li>
<li>大多数学者在写作时，即使碰到偏差与不符合规范的结果，也认为这不足以挑战这一原则。—— 指损失规避作为基础性原则。</li>
<li>作为这一观察的进一步支持，引入损失效应调节者作为一个证据但不是反对或者挑战损失规避的证据，而是被认作可能超出损失规避的在特定现象下应用的额外因素。</li>
<li>上面👆的例子就是，Chernev发现目标导向会影响现状偏差（status quo bias）的等级（degree），猜测有部分因素可以潜在地越过损失规避原则，因此得到结论：对现状的偏好可以导致独立于损失规避原则的结果。原文：For example, Chernev (2004) found that goal orientation affected the degree of the status quo bias, and speculated that some factors “could potentially override loss aversion effects” (p. 564). Chernev, thus, concludes that “the preference for the status quo can occur independently of loss aversion” (p. 557).</li>
<li>这一理论的提出虽然仍旧没有挑战损失规避的原则地位，但提出了有其他的因素可能会在指定的情景下导致相反的结果。</li>
</ul>
<h2 id="进两步补充">进两步补充</h2>
<ul>
<li>损失规避被定义成了描述性的原则，而不是解释性的。因而，损失规避被明确解释为一个描述行为的，而不是解释行为的原则。</li>
<li>损失规避被认作是解释前景理论的关键处，被描述为选择的描述性模型。原文：To illustrate, prospect theory, of which loss aversion is a key parameter, has been described by its progenitors as a “descriptive model of choice” (Tversky &amp; Kahneman, 1986, p. S255).</li>
<li>Thaler elaborates on this notion and states that “Descriptive theories try to characterize actual choices. Prospect theory is an example of a descriptive theory” 这是说前景理论只是描述性理论的一个例子，或者说子部分。</li>
<li>因此，损失规避被定义为独立于任何心理活动，可以解释是什么造成的。原文：As such, loss aversion is defined independent of any specifific psychological process account for what causes it.</li>
<li>尽管如此，研究者们仍使用它来解释一些现象，这些相同的现象都被视作支持损失规避的证据。原文：Despite this, researchers use loss aversion to explain phenomena (Camerer, 2004), and those same phenomena tend to be proffered as evidence of loss aversion (Camerer, 2006)</li>
<li>禀赋效应，或者说厌恶剥夺（endowment effect），短暂地描述标记为是支持损失规避的证据，损失规避当成厌恶剥夺的解释。</li>
</ul>
<h2 id="part-1-结个尾">Part 1 结个尾</h2>
<ul>
<li>In short, loss aversion has been regarded as a fundamental principle whereby losses loom larger than gains, and it is thought to characterize human behavior. We next provide a critical review of the evidence for this idea.</li>
<li>它被表征为人们的行为？</li>
</ul>
<blockquote>
<p>10.19更新</p>
</blockquote>
<h1 id="part-2-evidence-for-loss-aversion">Part 2: Evidence for Loss Aversion</h1>
<blockquote>
<p>如果将损失厌恶作为通用心理学原则，我们期待（能）看到什么呢？</p>
</blockquote>
<p>取决于损失厌恶是如何定义的，这里考虑两种形式的损失厌恶。</p>
<h2 id="第一种形式">第一种形式</h2>
<p>Strong version，关键词 Never，损失造成更大的心理压力，远远超过收益带来的效用。</p>
<ul>
<li>但这个版本没有要求在所有环境下，损失带来的效用损失远远超过收益带来的效用提升</li>
<li>认为因为测量误差跟边界条件可能会掩盖或者减少损失带来的心理落差超过收益带来的效用提升</li>
<li>如果要接受这种理论，那么就不应该观察到收益带来的效用远远大于损失带来的压力</li>
</ul>
<h2 id="第二种形式">第二种形式</h2>
<p>该种被当作通用原则，也被叫做Weak version，即损失超越或者相等于收益带来的效用。</p>
<ul>
<li>该类允许在一些语境下出现人们对收益表现出极大的效用</li>
<li>或者出现大量的数据支持损失大于收益，或者相对平均的数据支持损失大于收益带来的效用</li>
<li>如果上述两种情况都不满足，那么需要考虑第三种情况并考虑该原则的可行性，也即在情景化情况下，与损失和收益有关的心理过程强度会影响损失与收益的相对关系。</li>
</ul>
<p>在这个章节中，回顾了多样情景下损失厌恶的证据，包括低风险选择，风险选择，损失与收益的相对收益率，现实世界的现象，以及信息框架。同时还发现有些被认为是损失厌恶的证据，但事实并非如此，涉及到损失与收益的效用对比。最后，我们对这些证据的讨论结束于弱损失厌恶与强损失厌恶同时作为基本原则。</p>
<h2 id="无风险选择">无风险选择</h2>
<ul>
<li>status quo bias（）</li>
</ul>
<p>现状偏差：个人更倾向于选择现状，而不是其他替代选择，被归因于损失厌恶，因而被认为是支持损失厌恶的证据。</p>
<p>尤其是，损失厌恶理论认为，失去现状选项比获得替代选项的收益要大。</p>
<p>但 Ritov and Baron 提供证据显示，现状偏差不是因为倾向于现状，而是倾向于保持现状，无行动胜过行动（单纯是不想改变）。</p>
<p>同时，还表示一个人面对是否做一些事情还是不做事情的时候，如果什么都不做可以维持现状。但当什么都不做现状将被改变时，那么将倾向于选择做点什么事情维持现状。</p>
<p>Schweitzer 在1994年的文章里发现，有时候一些对现状的坚持仅仅是为了选择保持现状，虽然 R &amp; B 没发现这一现象。</p>
<p>以上理论不管接受度如何，都不支持用损失厌恶理论来解释现状偏差。因为如果用损失厌恶来解释这一现象，那么所有人都应该选择不做任何事而不是现状偏差。换句话说，不应该是损失的效用比收益大，而是行动之后损失的事物要比行动后的收益大。</p>
<p>同时，对不行动的倾向并不涉及损失厌恶。Gal 的惰性账户（inertia account）陈述道，人们对选择漠不关心，他们喜欢不做任何选择，因为做出选择需要心理动机支持。</p>
<p>或者，会出现对不作为的偏好，因为人们通常喜欢减少处理事务及交易成本。</p>
<p>Ritov &amp; Baron：对此做出的解释是即使是不作为造成了错误也比作为了造成错误更好，基于“东西没坏就不修”的原则。</p>
<p>Gal（2006）问参与者，是否愿意将一个物品与一个几乎同等价值的物品进行交换，Kahneman（2011）指出当使用同等价值的货物进行交换时，损失厌恶是不起效的，因为人们没有对损失和收益进行编码，实验中85%的参与者都表示会保持原有物品。</p>
<p>文中复现了这一实验结果，MTurk的149名参与者被询问是否愿意用同等20美元的账单交易一张20美元的账单（change option），或者保持原有收到的20美元账单（status quo option）。一个版本是只让参与者选择这两个选项，另一个版本是，他们能够对选项表示漠不关心。</p>
<p>虽然 Kahneman 表示这并不适用 Loss Aversion，因为得失不会被计量，但我们还是可以清晰地看到选择趋向现状。因此，再一次，现状偏差不应该视作损失厌恶的表现/证据。</p>
<p>总之，仅仅是现状偏差不能提供观察损失是否远大于收益带来效益的视角。现状偏差可能是处于对现状失去的损失远大于另一种的获得，但也平等地可能由于其他的因素导致倾向于不作为（维持现状）。</p>
<ul>
<li>The endowment effect（禀赋效应）</li>
</ul>
<p>禀赋效应是无风险决策情境下最支持损失厌恶效应的现象(Kahneman et al., 1990; Thaler, 1980; Tversky &amp; Kahneman, 1991)</p>
<p>禀赋效应发现，对事物有需求的人比对没有需求的人愿意付出更多去获得它。(Thaler, 1980). Kahneman 的研究表明，有强烈mug需求的，会愿意支付7美元去获得它，但与此相对，没有需求的则仅愿意支付3美元。这个研究从大量的禀赋范例中发现，人们获得的意愿（WTA）比付出的意愿（WTP）要大得多呈现 Robust 。</p>
<p>这就是最大的发现，被当作是一个支持损失强烈大于收益带来的效用的证据。</p>
<p>当包含可选的选项是不做任何行动时，也被认为是现状偏差的一种情况。因此，禀赋效应同样受制于现状偏差的同类解释。</p>
<p>例如：当前解释是当人对endowed选项与nonendowed option时，他们会选择维持endowed option因为缺失贸易激励，并不是因为损失endowed option的效用会远大于采用 nonendowed option带来的效用。</p>
<p>另一种对禀赋效应的解释（）：</p>
<p>首先，作者提供了不同的价格参考账户。他们认为，当设置WTP账户与WTA账户时，买方和卖方面临基本不同的决策会导致他们关注不同的参考价格。</p>
<p>对于买方，从购买对象的个人用途是他最好的参考。对于卖方，基于市场上的价值定价是最好的参考。作为结果，卖家会倾向于多对产品进行调查而不是向潜在买家询问支付意愿。</p>
<p>举个例子，拥有者和未拥有者同时评估一个物体为3美元，但市场定价为7美元，拥有者（owners）会以7美元评估它，而未拥有的（nonowners）则仅愿意以3美元获得它。</p>
<ul>
<li>From：Weaver and Frederick (2012) and Isoni(2011) (see also Simonson &amp; Drolet, 2004; Yechiam,Ashby, &amp; Pachur, 2017)</li>
</ul>
<p>与惯性（inertia）一样，该帐户（account）不需要对损失有不同的敏感性来解释禀赋效应。</p>
<p>其他的禀赋效应范例中也存在困惑，例如，WTP与WTA在不同的场景下被评估时，WTP根据个人的支付能力是有界的，但WTA不是。</p>
<p>讨论到目前，禀赋效应使用损失厌恶中的可能另类解释，不论是endowed还是nonendowed，对选项的评估都没有什么不同。</p>
<p>然而，研究发现，人们困惑于是否放弃endowed option，倾向于更加关注积极因素，而不是面临选择的时候是否该接受选项。</p>
<p>难以理解：与未授予期权相比，此过程可能导致期权获得更高的估价，因此，可以将其解释为在授予效应的背景下导致损失产生更大收益的过程。</p>
<p>原文：This process could result in greater valuation for an option when it is endowed than when it is not endowed and, therefore, could be interpreted as a process that leads losses to loom larger gains in the context of the endowment effect.</p>
<p>两个注意事项（caveats）：</p>
<p>首先，在损失与收益与作为与不作为的关系让人困惑，不是评估一个选项的损失，而是趋向于评估无所作为。</p>
<p>其次，即使有人接受禀赋效应在非情境下评估选项可能导致损失，也不意味着接受损失厌恶的解释，而是，损失大于收益的一般性原则。</p>
<p>所以，如果要把损失远大于收益作为一般性原则，至少需要在不同情境下提供损失大于收益的证据，并且不要把损失与收益 和 作为及不作为混为一谈。</p>
<blockquote>
<p>10.25 更新</p>
</blockquote>
<ul>
<li>Retention paradigm（留存范式？）</li>
</ul>
<p>Gal 与 Rucker 提出 Recent effort，指出经典的现状偏差以及禀赋效应的不足，并想要提供一个可替代损失远大于收益的实验，也就是替代损失厌恶的解释。</p>
<p>留存范式将损失与收益和作为与不作为分割开来，留存范式涉及到对参与者愿意付出的最大代价获得某一样物品与参与者被询问愿意付出的最大代价来留存之前拥有的事物。</p>
<p>它的核心特征在于，最大留存意愿，为了减少与损失厌恶的影响的混淆（confounded）</p>
<ol>
<li>首先，最大回购意愿与最大支付意愿的对比，将损失与收益从作为与不作为中剥夺出来了，因为参与者不做行动就无法获得物品，也就是，两种情况下参与者都需要行动以在最终获得物品；</li>
<li>而且，在WTP 与 WTP-Retain之间的比较，消除了参考价格的差异；所有这些情况下都需要考虑他们自身的效用；</li>
<li>第三，留存范式消除了潜在的WTP与WTP-Retain的相似性带来的一个支付能力的边界；</li>
</ol>
<p>那么，如何验证是否支撑损失厌恶呢？</p>
<p>人们应该表现出强烈的害怕损失，远远超过于得到，因此，WTP应该远远小于WTP-Retain。Strong version下，WTP 远小于 WTP-Retain，weak version下，WTP应该多数小于WTP-Retain，至多是相等的。如果固定相等，那么这便会挑战损失厌恶作为一般性原则的地位。如果结果相反，那么人们表现为收益追求。</p>
<p>问题来了，为什么人们愿意支付去维持已有的事物呢？</p>
<p>Caveat：前提条件是需要设计好情景，被指派为WTP-Retain的参与者需要避免交易损失来支付感知交易是否公平。</p>
<p>Gal 与 Rucker 设计了一些情景：</p>
<ol>
<li>WTP to repair a broken phone (vs. WTP to obtain a repaired phone)</li>
<li>Willingness to expend time to drive to obtain an accidentally left behind unused, new-condition notebook (vs. willingness to expend driving time to obtain a new notebook at no financial cost)</li>
<li>willingness to pay to retain services（虽然服务没有实际的归属，但也会将损失服务当成损失）</li>
</ol>
<p>For example, if one’s Internet service expires at the end of a month, its loss is likely to be construed as a loss even though one does not have indefinite ownership rights to the service.</p>
<p>Gal 与 Rucker实验的结果是，大多数情况下，留存的意愿与获得的意愿差不多。对于一些平凡的货物，获得的支付意愿要比留存的支付意愿大得多。</p>
<p>最重要的是，参与者在实验中把Retain当成了他们的损失，Obtain当成了收益，在互联网服务的场景下，85%的Retain实验者都认为是在避免损失，而只有9%的Obtain实验者这样认为。</p>
<p>因此，留存范式试图找出一个替代现在所有的范式来实现更有效的损失厌恶实验，却并没有提供更多的支持。所以，目前所有的范式都在倾向于挑战损失厌恶作为一般性原则的地位。</p>
<ul>
<li>Discrete retention paradigm（离散留存范式）</li>
</ul>
<p>简单描述就是一个离散的禀赋范式，并不是陈述价值，而是给了个选择保持赋予期权还是交换之后得到一个可替代的无期权选择。</p>
<p>人们更喜欢赋予期权的选择，而不是赋予非期权的选择。但人们只是选择去保持一个赋予期权的选择，而不是去交易得到一个非赋予期权的选择。人们选择维持赋予期权的选择被认为是损失厌恶的支撑。</p>
<p>然而，一个不足之处是，在非离散的情况下，损失与收益就跟行动还是不行动产生了混淆。</p>
<p>我们建立了一个离散的留存范式来解决这个混淆，在这个范式中将留存期权与交换期权作为替代选项，使得两个选项都是active，而不是不作为。比如获得0美元来维持或者用期权来交易可替代产品。</p>
<p>损失厌恶理论表明，人们应该是更喜欢期权而不是非期权选择。也就是，对于给定的物品，当是endowed option情况下对于特定商品的选择会更高于alternative option。</p>
<ol>
<li>第一个实验中，182位实验者被赋予一支笔或者一个巧克力棒，被要求选择是否交换可替代的物品。第二个实验中，参与者被赋予5美元或者一个带有他们最喜欢球队logo的杯子，被要求选择是否交换可替代物品。</li>
<li>在这两个实验中，不论是endowed option还是nonendowed option，杯子的选择率都是一样的。</li>
</ol>
<p>离散留存范式中，结果很有趣，以实验二为例，被指派为杯子的情况，26%的人选择了维持杯子，被指派为初始5美元的人有26%选择了更换成为杯子。不管初始被指派的是杯子还是钱，都只有26%的人选择。</p>
<p>离散指派范式中，被指派为杯子的情况下41%的人选择维持杯子，但被指派为5美元的情况下只有18%的人选择杯子（）。</p>
<p>因此，在与损失厌恶理论的预测对比，通过一个小小的过程改变也就是是否将损失与收益从行动还是不行动分割，以消除对被指派选择的偏好，来决定持有哪个范式。</p>
<h2 id="风险选择">风险选择</h2>
<p>K &amp; T认为，大多数人认为平等的赌注及概率毫无吸引力。 most people find symmetrical bets of the form (x, 0.50; !x, 0.50) distinctly unattractive.</p>
<p>如果一个人提供了一个赌注为5美元，有50%的概率失去5美元，但同时有50%的概率获得X美元，这时，人们会要求X是10或者更多，K&amp;T认为这很有效地反映了人对损失的心理感知效应，并且很好地与收益做对比。</p>
<p>Gal 在2006年就反驳道，风险投注溢价是一种现状偏差的特例，适用于现状偏差与禀赋效应的说明同样适用于风险投注溢价，不接受赌注的人视作inaction，接受的人视作action。因此，对于这个赌注是对喜好不行动还是行动的倾向反应，还是说明了一般性的损失大于收益的趋势并不明确。</p>
<p>为了将损失与收益和行动还是不行动从风险选择的情境中分离出来，Gal 展示了风险赌注的参与者，在无关是否行动的情况下，关于接受赌注还是不接受赌注的实验。</p>
<p>在一个假想的决策中，每个人分配100美元，可以选择安全确定地得到3%，以及一个预期收益为0的选择。80%的人至少分配了一部分资金到预期收益为0的选择上，约20%的人全部放在了预期收益为0的决策上，一个人把资金全部放在了安全选项上。—— gain seeking</p>
<p>其他的研究人员有相似的发现，当给定多种投资选项，对高收益的风险选项的倾向远超安全选项的倾向。</p>
<p>提供一个选项，50%的概率损失或者获得1000点，或者安全获得0点。52%的人选择冲，剩下的人选择留。当赢或者输的赌率不被认为是行动选择时，在风险决策的papers中，超过30篇都是鲜于支持Loss Aversion的。</p>
<p>我们要求参与人员想象面临一个决策，0 或者 0.5 15，然后结果如下：</p>
<figure data-type="image" tabindex="1"><img src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/abda03c3-ee6d-42d8-b1ad-7e863d95a13e/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/abda03c3-ee6d-42d8-b1ad-7e863d95a13e/Untitled.png" loading="lazy"></figure>
<p>上述那些倾向于风险决策的都是低到中的赌注，在一些涉及高赌注的实验中呈现一个选择安全决策的倾向。但，损失厌恶可没说低还是高风险，可不涉及风险水平。</p>
<p>事实上，归因于损失厌恶影响的小额赌注已经被发现，且被认为是支持损失厌恶的强有力证据。那么，为什么这么关心小额赌注呢？</p>
<p>这是为了避免大量纲情况下，可以被归因于环境或者财富的改变而被风险厌恶解释，风险厌恶已经是完全一致合理理论，且在涉及小额赌注的损失时失效，因为不涉及财富或环境的巨大变化。</p>
<p>假如失去5美元就倾家荡产，得到则富可敌国，那么此时损失的效应就比得到要大。</p>
<p>如果 0.5 1 0.5 1 以及 0.5 4 0.5 4，那么49%选前者。</p>
<p>与损失厌恶相反的是，研究发现个体没有低风险厌恶在或者1000，或者0/2000；than；选择0，或者-1000/1000；</p>
<p>在回顾了整个risky choice情景下损失厌恶的证据之后，很少有支持损失厌恶的。</p>
<h2 id="损失与收益的影响比例">损失与收益的影响比例</h2>
<p>有争论的是，也许大多数直接测试损失厌恶的情况下，评估损失与收益的相对影响是没问题的。然而，当研究人员开始将损失与厌恶比例化之后，鲜有支持损失厌恶的。</p>
<p>以前的实验都是聚焦于金钱的得失带来的损失与收益的影响评估，那么对于非金钱的呢？研究发现，得到带来的积极效应是要超过失去时带来的消极效应的。</p>
<p>例如失去一个杯子，以及获得一个杯子，编码其消极效应到积极效应为-5至+5，那么前者的M为1.38，后者为2.71。在一些其他的对象中，发现这两者是没区别的，但没有对象的研究中是损失大于积极效应。</p>
<p>在同样询问参加实验的人员，失去跟得到50美元的感受，得到的结果跟损失厌恶理论是一样的，的确认为损失的影响要超过收益。</p>
<p>但这被认为是大额Stake，因为失去50美元可能发生的变化会比较大，因此可以用理性选择理论去解释，人们总是更愿意考虑失去对自己的影响。然而，损失与收益的相对影响是小额且并不影响一个人的环境，当小额牵涉的时候，损失大于收益的看法是非理性的。</p>
<p>Muk复刻了那一实验，发现在低额度的情况下，人们总是认为收益带来的效用更大。而额度增大之后，对损失的感知要强于对收益的感知，这说明存在语境因素影响实验者对收益与损失的比例，这个实验表明，有个调节器在调节何时损失大于收益。但这样以来，这个调节器何时被触发未知就会导致，在高风险实验时，到底是因为损失的效应大于收益还是因为单纯的风险厌恶。</p>
<p>所以结论为没有找到明确的证据表明对损失的心理效应远大于收益有明显的优势（predominance）。</p>
<blockquote>
<p>10.27更新</p>
</blockquote>
<h2 id="real-world-phenomena">Real-World Phenomena</h2>
<p>大量记录在案的现实世界的现象被认为是损失厌恶的支持证据，分析几个最被认为支持损失厌恶的现象。</p>
<p>现象一：巨大的需求弹性，价格上升时需求减少比价格下降时需求增加的多，这被认为是损失厌恶的支持。因为顾客被推定（presume）为解释成价格上升为损失，价格下降为收益。</p>
<p>反驳解释：这是因为顾客对价格上升与价格下降的响应是异质的，所以不能这么去看。我们设计的实验中，从小于1%到大约10%的价格浮动时，个体并没有表现出不一样的需求变化。</p>
<p>现象二：equity premium puzzle，股权溢价之谜。指的是股票比债券（无风险证券）的回报率更高，股票比债券（无风险证券）危险，与之相反的是相对债券的股票投资不足，这被用损失厌恶来解释。</p>
<p>反驳解释：然而损失厌恶只是众多解释中的一个，且其他解释中它根本不算是一个puzzle。在观察到股权溢价的时间段内，相对于债券而言，股票的相对较高的已实现回报不一定是先验的。总之，这不能阐述清楚投资者在相对已知风险-收益权衡下的低投资。</p>
<p>外援：Benartzi and Thaler(BT)(1995)基于<a href="https://wiki.mbalib.com/wiki/Kahneman">Kahneman</a> and <a href="https://wiki.mbalib.com/wiki/Tversky">Tversky</a>(1997)的预期理论，提出投资者如何偏好在国库券和股票之间分配其<a href="https://wiki.mbalib.com/wiki/%E9%87%91%E8%9E%8D%E8%B4%A6%E6%88%B7">金融账户</a>，即人们在选择投资组合时，会对每一种资产计算其潜在的收益和损失，然后选择期望效用最高的那一个。由于投资者对其<a href="https://wiki.mbalib.com/wiki/%E8%AF%81%E5%88%B8%E7%BB%84%E5%90%88">证券组合</a>的可能损失存在着厌恶心理，因此会格外的关注其资产组合的安全性，这种关注使得投资者频繁的对其证券组合进行着<a href="https://wiki.mbalib.com/wiki/%E7%BB%A9%E6%95%88%E8%AF%84%E4%BB%B7">绩效评价</a>，由于股票价格具有较大的波动性，暂时性损失的概率要远远高于债券，频繁的绩效评估，会使投资者越来越多的感受到股票资产上所发生的损失，从而降低股票对投资者的吸引力。只有当股市上的长期<a href="https://wiki.mbalib.com/wiki/%E5%B9%B3%E5%9D%87%E6%94%B6%E7%9B%8A">平均收益</a>维持在较高水平时，投资者才会将股票和债券看作是可替代的。也即在短视性损失厌恶理论条件下，股市上存在的高水平股权溢价只是维持股票和债券两种资产之间均衡关系的必要前提，股权溢价之谜不能称之为“谜”。</p>
<p>现象三：持续出现一些与支持损失厌恶相反的现象，如gain seeking。如在股票市场的过度交易（overtrading），被评判为理性假设的投资人。为了作为现状偏差的扩展来支持损失厌恶，可以解释为支持收益寻求行为。因此，虽然从广泛的文献中，经常被引用为损失厌恶的证据，但真实世界里的现象都不支持。</p>
<h2 id="message-framing">Message Framing</h2>
<p>引言：对于损失厌恶的扩展，人们会对loss-framed出现的反应过度于gain-framed。</p>
<p>反驳：然而，消息框架所呈现出来的结果并不支持哪怕是weak version的损失厌恶。健康相关的消息情景，O’Keefe and Jensen (2007)对93篇studies超过20000个实验参与者的荟萃分析，没有发现哪怕一种情境下，出现了上述情况。在疾病预防的消息中，反而是gain-framed的出现次数远大于loss-framed。</p>
<h2 id="phenomena-that-do-not-involve-comparing-losses-to-gains">Phenomena That Do Not Involve Comparing Losses to Gains</h2>
<p>引言：大量的现象有时支持损失厌恶，事实上都是牵扯到损失与收益对比的实验，不提供损失厌恶的实验。</p>
<p>现象一：亚洲人疾病问题。那里的人更愿意去避免承担损失生命的风险，而不是去避免承担拯救同一条生命的风险，有时也被认为是支持损失规避的。</p>
<p>解释：然而，这个现象反映了反射效应（reflection effect），在损失域里是风险寻求的，在收益域里是风险厌恶的。实验发现，在风险域减少他们的风险并不影响决策，使得风险寻求，同样的，在收益域减少他们的收益并不影响他们实行风险厌恶的策略。</p>
<p>现象二：处置效应（disposition effect），在股票市场有这样的趋势，胜利者趋向于抛售股票，而失败者趋向于保持股票。这也被认为是支持损失厌恶的效应之一。但这同样可以使用反射效应来解释。</p>
<p>现象三：沉没成本效应（sunk cost effect），一个趋向于继续努力而不管之前投入的时间，金钱以及时间，也被认为是损失厌恶的支持。然而，这只能说沉没成本效应勉强（reluctance）表示一种认知损失的方式，而不是损失的效应远远大于收益。</p>
<h2 id="summary">Summary</h2>
<p>总结一：在本章节提到的这些现象，都是不支持损失厌恶的。不论是Strong Version还是Weak Version。</p>
<p>总结二：强损失效应范式表明，损失厌恶是一般性原则，而且损失远远大于收益的效应；弱损失效应范式表明，损失厌恶可以存在损失与厌恶的效用近乎相等，但大多数情况下，损失要大于收益。</p>
<p>总结三：该章节的主要内容提出，在情境下的视角去观察损失与厌恶的相对情况。</p>
<h1 id="part-3-the-sociology-of-loss-aversion">Part 3 The Sociology of Loss Aversion</h1>
<p>引言：尽管有相反的证据，我们认为持续和普遍接受损失厌恶是一个有趣的社会学现象。事实上，厌恶损失得益于一种抵制不同观点的现状偏见或许是恰当的。在这里，我们考虑为什么接受损失厌恶是研究人员中如此持久的信念，并将其与科学家中更广泛的信念持久性观点联系起来。特别是，我们关注的是厌恶损失已经成为科学共识的观点，这种观点本质上是抵制变化的。此外，我们还讨论了厌恶损失具有显著的直觉吸引力的观点，以及它可能反映了一种过度概括的趋势。</p>
<p>科学共识：库恩(1962)的《科学革命的结构》是一部研究科学信仰的本质和演变的开创性著作。库恩认为科学是一个基本的社会过程，通过共识来定义科学真理。根据库恩的说法，证据是根据科学家在给定时间接受的主观世界观或一套公认的信念来评估的。库恩(1962)将正常科学定义为“基于一个或多个过去的科学成就的研究，某些特定的科学团体认为这些成就为其进一步的实践提供了基础”(库恩，1962，第10页)。库恩(1962)将这些成就称为范式，并认为要被科学界采用，它们必须是前所未有的，以吸引来自科学研究其他领域的一群追随者，并且是开放的，以便为研究人员留下问题来追求，从而建立在范式之上。他进一步认为，范式对于界定一门学科和界定重要的研究问题至关重要。范例是如何被接受的？库恩(1962)认为，“范式之所以获得地位，是因为它们比竞争对手更成功地解决了一些实践者已经认识到非常尖锐的问题”(库恩，1962，第23页)。前景理论(Kahneman &amp; Tversky，1979)，其中损失厌恶是一个关键原则，适合这种模式。它之所以成立，是因为它提出了一个模型，该模型解释了理性选择假设的重要异常，即个人的决策将反映对最大化期望值的偏好(即。，阿莱悖论，科雷兹，1953年；《反射效应》，马科维茨，1952年；低概率事件的过度加权，弗里德曼和萨维奇，1948；和损失厌恶，萨缪尔森，1963年；参见艾雷夫、埃特、普洛斯基、科恩和科恩，2017年的评论)。事实上，向理性选择理论提出的挑战和替代前景理论经常用库恩术语来表示(见拉宾，2002)。与库恩描述导致接受新范式的品质的方式相似，前景理论被认为是足够前所未有和足够开放的，以吸引一群科学追随者建立在该模型之上。杰出的追随者跨越许多领域，包括理查德·塞勒、科林·喀麦隆、邓肯·卢斯、马克斯·巴泽曼、乔治·洛温斯坦和埃尔克·韦伯(西蒙松，2014)。此外，前景理论引入了新的和重要的实验范式，产生了有趣和稳健的结果，如禀赋效应。库恩(1962)认为，正常科学的关键活动是(a)收集与范式相关的事实(例如，通过实验)，(b)将事实与范式的预测相匹配，以及(c)进一步阐明范式。因此，正常科学是“试图迫使自然进入范式提供的预先形成的相对不灵活的盒子”(第25页)。与此同时，很少有人关注异常的识别，在发现异常的情况下，它们往往会被忽视、忽视或忽略。事实上，库恩(1962)指出，许多基于范式的研究是证实性的，旨在揭示研究者已经相信是真实的，因此受到证实偏差的影响(另见格林沃尔德，普拉卡尼斯，莱普，鲍姆加德纳，1986)。一个结果是证实该理论的文章被发表和引用，而那些没有被发表或被忽略的文章。以这种自催化的方式，一种范式作为科学界的共识变得越来越根深蒂固。我们可以从科学文献围绕前景理论发展的方式中看到这种模式，特别是对损失的厌恶。发表了许多研究文章，致力于收集与范式相关的数据(例如，泰勒，1980)，将数据与范式进行匹配(例如，贝纳茨和泰勒，1995；哈迪等人，1993年)，并进一步阐明范式(例如，11月维斯基和卡尼曼，2005年；Tversky &amp; Kahneman，1992)。与倾向于通过范式的视角来看待证据的观点相一致，支持厌恶损失的证据受到了极大的关注，而相反的证据往往被忽视。例如，2016年，哈迪等人(1993年)的一篇支持损失厌恶预测的文章获得了65次谷歌学者引用，而贝尔和拉廷(2000年)的一篇质疑哈迪等人(1993年)解释的论文仅获得14次谷歌学者引用。作为另一个例子，即使不涉及损失和收益的相对影响的比较的现象也被归因于损失厌恶(例如，阿克斯&amp;布鲁默，1985)。库恩(1962)认为，随着范式变得根深蒂固，它越来越抵制变化。当一个不容易被忽视的异常最终被发现时，科学家们将试图调整他们的模型，而不是颠覆范式。为了消除任何明显的冲突，他们“将设计大量的表达和对他们理论的特别修改”(库恩，1970，第78页)。我们可以看到这种试图修改或调整损失厌恶的表达，或增加额外的参数，以响应稳健的，从表面上看，不方便的事实，即损失大于收益的概念(康斯克，1993；McGraw等人，2010年；11月斯基&amp;卡尼曼，2005；Prelec &amp; Loewenstein，1991)。例如，麦格劳等人(2010)认为，对损失和收益的影响的评级未能证明对损失的厌恶，因为人们倾向于在不同的主观尺度上评估损失和收益；诺维斯基和卡尼曼(2005)试图将厌恶损失与人们一直在买卖商品的观察相调和，认为“按预期”交易的商品不厌恶损失；康丝利克(1993)试图用证据来调和对损失的厌恶，即人们经常用赌博有消费价值的观点来打赌和玩彩票(也见普雷雷克&amp;洛温斯坦，1991)。这并不是说这些学者的方法本质上是错误的或无效的。我们相信他们已经揭示了关于比较损失和收益的困难，关于按预期交易的商品如何与不按预期交易的商品进行不同的评估，以及关于赌博的消费价值的见解。尽管如此，我们相信这些方法也揭示了，正如库恩所描述的，科学家倾向于调整和维护一个公认的范式，而不是面对矛盾的证据质疑其根本基础。总之，库恩(1970)关于科学思想如何变得根深蒂固，从而抵制变化的观点可能有助于解释尽管有相反的证据，但对损失厌恶作为一种普遍原则的接受是如何持续的。</p>
<p>直觉诉求与过度概括：科学家头脑中对损失的厌恶也可能源于这一想法的内在共鸣。尽管研究对此提出了警告，但人们的信仰倾向于跟随他们的直觉(尼斯贝特&amp;威尔逊，1977)。事实上，许多历史上棘手的科学思想可能比取代它们的思想更加直观。例如，宇宙的地心说(即地球是宇宙中心的想法)对于寻求将自己的存在视为有意义的人类来说可能是自然的。同样，疾病的瘴气理论，即疾病是由“坏空气”引起的观点，可能比疾病是由肉眼看不见的微生物引起的观点更直观。其他被取代的理论，包括拉马克的遗传理论(即生物将它们在生命中获得的特征传递给后代)、发光以太(即物质而不是纯粹的空性渗透到空间中的想法)和物质燃素理论(即特定物质是可燃物质的一部分，在燃烧过程中释放出来)，在当时可能也比取代它们的理论有更大的直觉吸引力。关于厌恶损失的直觉吸引力，一种深刻的共鸣可能存在，那就是强烈地感受到生活环境的负面变化。事实上，卡尼曼(2011)指出，厌恶损失的想法“除了一些经济学家之外，没有人会感到惊讶”(第304页)，并且“阿莫斯(Tversky)和我经常开玩笑说，我们正在研究一个我们的祖母非常了解的课题”(第300页)。然而，即使这种直觉在某些情况下是正确的，也并不意味着它在所有情况下都是正确的。也就是说，仅仅因为在一种情况下损失的相对影响大于收益的相对影响，并不意味着在所有情况下都是如此。尽管如此，历史上的例子表明，科学家经常过度概括，倾向于通过单一原因解释大量不同现象的宏大、支配性理论(维达，2010)。例如，行为主义认为某些行为是有条件的，并将其外推至包括所有行为(乔姆斯基，1959)。厌恶损失的直觉吸引力的另一个可能原因是，大多数人可能会联想到失去某些东西相当痛苦的情况，似乎比获得某些东西更痛苦。例如，我们中的一个人最近花了2000美元拯救了一只面临生命威胁的肠道堵塞的家犬。这只狗是一只从救助中心救出来的杂种狗，它的主人当初不会花2000美元买下它。然而，现在他已经成为家人的宠儿。虽然这种强烈感受损失的例子可能有助于厌恶损失的直觉吸引力，但事实上，它们并不代表厌恶损失。这是因为人们对他们所拥有的某些物品(或宠物)产生了依恋，从而比他们在依恋之前所拥有的或会拥有的更重视它们；这与厌恶损失的观点大相径庭，厌恶损失的观点认为，人们受损失的影响比受收益的影响更大，仅仅是因为他们位于中性参考点的不同侧。一般来说，可以说“厌恶损失”这个名字代表了从增强想法的直观吸引力的角度来看的特殊品牌，因为每个人本质上都厌恶损失(就像每个人都被收益所吸引)。这种良好的品牌可能会导致研究人员将现象识别为支持损失厌恶，尽管这些现象虽然涉及损失，但并不涉及损失相对于同等收益的影响的比较。如前一节所述，例子包括沉没成本效应、处置效应等。</p>
<h1 id="part-4future-directions">Part 4：Future Directions</h1>
<p>引言：我们认为，接受损失厌恶作为一般原则可能会产生不利的影响，使研究偏向于隐藏重要研究问题的验证性范式。为了说明，我们提出了新的方向，这些方向来自于对损失厌恶不是一般原则的认识。我们将这些列为“研究重点”，以鼓励该领域未来的工作。</p>
<p>研究重点1:探究情境在得失心理影响中的作用</p>
<p>也许，最明显的新方向是研究损失和收益作为背景函数的相对影响。为了详细说明，而不是假设厌恶损失，我们倾向于一种情境方法，鼓励研究人员询问何时损失大于收益，反之亦然。问这个问题并不仅仅是为了在损失大于收益时进行分类，反之亦然，而是为了更好地理解与损失和收益相关的心理过程。我们认为，对影响得失影响的心理过程以及影响这些过程相对强度的背景调节因素的日益关注，将有助于更好地理解得失如何影响行为。这种方法并没有避免在某些情况下或可识别的情况下损失大于收益的可能性，但它包含了这样一种研究前景，即事件可以被视为明显的损失，但不会比类似的收益产生额外的心理影响，甚至可能比类似的收益产生更小的影响。事实上，新兴研究的稳步增长与这一想法是一致的(例如，Erev等人，2008年；Ert &amp; Erev，2013；Ert &amp; Yechiam，2010；Hochman &amp; Yechiam，2011；慕克吉等人，2017年)。此外，随着越来越多的工作转向研究损失的影响等于或小于收益的情况，肯定需要从背景的角度进行评估。作为一个与背景方法一致的努力的最近的例子，考虑瓦拉斯克和斯图尔特(2015)的工作。作者引入决策抽样作为损失厌恶的一个潜在来源。简而言之，作者提出，个人可以证明损失厌恶，损失中性，以及损失厌恶的反转，作为他们可用的损失和收益范围的变化的函数。例如，与收益范围(例如，高达40美元的收益)相比，当损失范围较小(例如，高达20美元的损失)时，任何给定的损失都更具心理影响，因为它代表了最大损失的更大总量。相比之下，当收益的范围比损失的范围小(例如，高达20美元的收益)时(例如，高达40美元的损失)，任何给定的收益都被认为是更有心理影响的，因为它代表了最大收益的更大的总量。基于这样的程序，瓦拉斯克和斯图尔特(2015)报告了他们所谓的损失厌恶、损失中性和损失厌恶的反向的证据。尽管由于各种原因，人们可能会不同地权衡得失，但这些作者提供了一种见解，这种见解超越了作为基本原则的损失厌恶，并引入了与上下文相关的、面向过程的视角相一致的替代视角。在我们的工作中，我们还发现了一些结果，表明有必要研究损失和收益相对影响的调节因素。特别是，我们从本文前面讨论的保留范式和享乐影响评级中发现了初步证据(Gal &amp; Rucker，2017a，b)，即当涉及普通商品(如马克杯或互联网服务)时，收益相对比损失更有影响，而当涉及受保护商品时，如城镇的山景或湖边通道时，损失可能比收益更有影响(Gal &amp; Rucker，2017a，b)。一种可能的过程解释是，强有力的社会规范是为了保护自然财富而存在的，而这些财富不是为了更世俗的商品而存在的。这可能会导致人们愿意花更多的钱来保留(保护)这些商品，而不是获得它们。另一种选择是，受保护货物的损失被认为是不可挽回的，因此，可能被解释为不同于可以相对容易地替代的普通货物的损失。</p>
<p>研究重点2:了解损失和收益的不同影响</p>
<p>承认背景因素影响得失的心理影响并不意味着得失应该得到同样的对待。事实上，一个重要的问题出现了，即使在对感觉或接近/回避行为的影响程度相似的情况下，得失如何影响心理过程。事实上，一些研究人员提供的证据表明，尽管损失并没有像追求收益那样被避免，但与收益相比，人们可以更加关注损失(叶恰姆和霍奇曼，2013年)。同样，这些研究人员有16 Gal和Rucker认为，损失和收益对某些类型的行为有不同的影响，其中包括一些与消费者研究人员非常相关的行为，如消费者投诉。例如，即使他们避免损失的程度不超过追求收益的程度，但人们对损失的抱怨往往多于对收益的赞美(耶恰姆和霍奇曼，2013)。与之相关的是，对损失和收益之间的差异的研究可能会从仅仅关注损失和收益的影响的价值转向与损失和收益相关的特定情绪(参见，蒂登斯和林顿，2001)。因此，未来研究的一个潜在的有效途径是检查损失和收益是如何被不同地处理的，以及它们如何不同地影响特定的情绪和行为。</p>
<p>研究重点3:检查收益效用</p>
<p>消费者心理学家也可能对人们从获得商品(获得效用；这不应该与泰勒(1985)关于购买效用的定义相混淆，即与支出相比，所收到的商品的价值，或者与交易效用的定义相混淆，即消费者获得的“交易”的价值。先前对消费者行为的研究倾向于关注人们从拥有或使用产品中获得的效用或交易的效用(即，获得好交易的效用；泰勒，1985)，但相对很少有人关注获得产品或服务的效用。人们很可能从获得物品的行为中获得效用，而这种效用是从使用中的产品的价值或获得的物品的交易价值中获得的。迄今为止，这一想法几乎没有被研究过，这令人惊讶，因为外行经验表明，人们从获得东西中获得了很大的乐趣，无论是在购物时自己买东西还是作为礼物收到东西。我们中的许多人都熟悉那些喜欢购物的人，但似乎对丢弃他们很想购买但很少使用的物品并不感到内疚。事实上，最近的一项研究发现了与人们经常从获得新东西中获得快乐的想法相一致的证据，这些新东西可以超过失去已有财产的损失:Bellezza、Ackerman和Gino (2017)发现，消费者有时倾向于对旧产品粗心大意，以给自己一个升级到新产品的借口。对获得快乐的相对缺乏关注可能是由于研究人员通过厌恶损失的视角来观察消费者行为，从而关注损失的痛苦(例如，“支付的痛苦”，Prelec &amp; Loewenstein，1998)。无论如何，对收益效用的调查是人们为什么购买和获得东西的核心问题，这本身就是消费者研究的核心。作为对获得快乐的调查的一部分，研究人员可能会研究背景影响如何影响与获得东西相关的快乐。例如，在前期工作中，我们发现证据表明，人们更喜欢获得丢失的东西(例如，找到丢失的手电筒)，而不是获得新的东西(Gal &amp; Rucker，2017b)。</p>
<h1 id="conclusion">Conclusion</h1>
<p>总之，我们认为超越损失厌恶作为一个普遍的原则，接受一个关于收益与损失的心理影响的更有背景的观点，为重要的研究问题提供了富有成效的新开端。值得注意的是，这并没有从本质上否定或抹杀早期致力于损失厌恶研究的论文和范式的价值。的确，那些论文将永远是当时该领域的科学突破；他们引入了一个新的观点，即个人的判断往往会受到相对于参考点的损失和收益的影响，同等规模的损失和收益不一定会产生同等的心理影响。然而，我们的主张是，对损失厌恶的过度概括有可能混淆与损失和收益相关的心理过程，从而导致忽视收益在心理上也可能比损失更大的观点，或者在其他情况下，收益和损失将具有类似的心理影响。事实上，更加注重理解与得失相关的心理过程及其背景调节因素，可能会增加科学探究和复杂性，从而提高人类行为预测的准确性。因此，也许具有讽刺意味的是，如果这种潜力得以实现，厌恶损失的损失可能会比它的收益更大。</p>
<blockquote>
<p>第一次读文章草草结束，不能说没有收获，但实在是曲曲折折，读文章各种生词与效应，前半段是热情满满，生啃硬咬，到后来被老师push，必须马上快速读完出报告，开始草草了事。不知道该怎么说这次的收获，但愿能有更多的时间去试试自己完整啃完文章。<br>
推荐快读情况下的辅助工具，知云文献翻译，软件开发者应该是买了百度AI翻译的API，所以翻译的准确度还算可以，推荐使用。</p>
</blockquote>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[杂谈]]></title>
        <id>https://py.qiuxiangzhi.top/post/za-tan/</id>
        <link href="https://py.qiuxiangzhi.top/post/za-tan/">
        </link>
        <updated>2020-09-14T15:16:52.000Z</updated>
        <content type="html"><![CDATA[<p>9.25</p>
<p>才刚开始研一生活没多久，就开始想这些杂七杂八的东西。太累了，不如好好休息好好学习。</p>
<p>应该相信自己值得更好的。</p>
<p>给自己安利一首歌：<a href="https://www.youtube.com/watch?v=h77E8pL0f-M">Undo</a>。</p>
<p>9.29</p>
<p>事实证明，Latex的编写确实可以比较复杂。做到那篇文章的复杂度说明对Latex很了解了，难怪会有一种看大佬的视角。</p>
<p>所以，这说明只有自己变得优秀才能吸引到人不是，我能好好学习了叭。</p>
<p>Latex只是工具，而且我发现Markdown对转成docx与pdf、Latex的支持都很好，为什么不尝试直接用Markdown，然后需要什么转什么呢。</p>
<p>10.4</p>
<p>淦，这段被吞了四次。</p>
<p>就是单纯吐槽 <code>吐槽不能使人轻松起来</code> ，这么难的吗？我好想锤死这个软件。。。</p>
<p>国庆过的很快乐，有其他城市的小伙伴来这里探望我，当然也不只探望我，但我可以自己心里这么想。然后就能快乐一点，虽然也没有感到更快乐。</p>
<p>补上前段时间我推荐的两首歌，就是觉得轻缓，歌词没仔细去看，凑合听个调调。</p>
<blockquote>
<p><a href="https://qiuxiangzhi.top/post/Save-myself/">Pa Zi - Spanglish Version</a><br>
<a href="https://qiuxiangzhi.top/post/Save-myself/">You broke me first</a></p>
</blockquote>
<p>10.10</p>
<p>我觉得我需要休息一阵子，因为一去图书馆就觉得困得不行。。。</p>
<p>加上最近老是觉得自己饿，体重也无法维持就离谱。😈</p>
<p>还是要保持下体重的，至少得保持在140吧，往下掉的话男生也太瘦了，多吃肉多运动。而且也可以趁此偷个懒？哈哈哈哈哈🙅‍♂️</p>
<p>下面这首歌真带感，但我不想Savage Love，哈哈哈</p>
<blockquote>
<p><a href="https://qiuxiangzhi.top/post/Save-myself/">Savage Love</a></p>
</blockquote>
<p>10.19</p>
<p>去了杭州两天，整个人的精神状态确实好很多了。</p>
<p>一是对未来工作的焦虑减轻了很多，因为这的确是没必要也很没道理的事情。</p>
<p>二是对于南京，这个未来需要待三年的地方，少了些抵触，多了分亲切。</p>
<p>但不知为何，总是希望去经历不一样的精彩，可又没有办法去选择，无法接受平庸可我依旧平庸。</p>
<p>大概，晚安，打工人？</p>
<blockquote>
<p><a href="https://qiuxiangzhi.top/post/Save-myself/">写给父亲的散文诗</a></p>
</blockquote>
<p>12.14</p>
<p>人已经好了，正常了，感觉上面的就是一个中二病青年是不是该有的矫情阶段。矫情过了，人自然就好了。</p>
]]></content>
    </entry>
</feed>